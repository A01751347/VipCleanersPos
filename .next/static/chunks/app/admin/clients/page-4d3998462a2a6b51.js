(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7097],{4516:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},12318:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},13052:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},13495:(e,t,s)=>{Promise.resolve().then(s.bind(s,37410))},13717:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},17580:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},19420:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},28883:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},37410:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>g});var a=s(95155),c=s(12115),l=s(12318),i=s(91788),r=s(51154),n=s(53904),d=s(47924),o=s(17580),x=s(19420),m=s(28883),h=s(4516),p=s(69074),u=s(92657),f=s(13717),j=s(42355),y=s(13052),v=s(6874),N=s.n(v);function g(){let[e,t]=(0,c.useState)(""),[s,v]=(0,c.useState)(1),[g,b]=(0,c.useState)([]),[k,w]=(0,c.useState)(0),[A,M]=(0,c.useState)(1),[z]=(0,c.useState)(10),[D,C]=(0,c.useState)(!0),[_,E]=(0,c.useState)(!1),[S,q]=(0,c.useState)(null),L=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;try{E(!0);let e="/api/admin/clients?page=".concat(t,"&pageSize=").concat(z);a&&(e+="&search=".concat(encodeURIComponent(a)));let s=await fetch(e);if(!s.ok)throw Error("Error al cargar los clientes");let c=await s.json();b(c.clients||[]),w(c.total||0),M(c.totalPages||1),q(null)}catch(e){console.error("Error fetching clients:",e),q("Error al cargar los clientes. Intente nuevamente.")}finally{C(!1),E(!1)}};(0,c.useEffect)(()=>{L()},[]);let I=()=>{L(s,e)},R=async()=>{try{let t=await fetch("/api/admin/clients/export?search=".concat(encodeURIComponent(e)));if(!t.ok)throw Error("Error al exportar");let s=await t.blob(),a=window.URL.createObjectURL(s),c=document.createElement("a");c.href=a,c.download="clientes_".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(a),document.body.removeChild(c)}catch(e){console.error("Error al exportar:",e),alert("Error al exportar los datos")}},U=e=>new Date(e).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric"}),H=e=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-[#313D52]",children:"Gesti\xf3n de Clientes"}),(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Administra la informaci\xf3n de tus clientes"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsxs)(N(),{href:"/admin/clients/new",className:"inline-flex items-center px-4 py-2 bg-[#313D52] text-white rounded-lg hover:bg-[#3e4a61] transition-colors",children:[(0,a.jsx)(l.A,{size:16,className:"mr-2"}),"Nuevo Cliente"]}),(0,a.jsxs)("button",{onClick:R,className:"inline-flex items-center px-4 py-2 bg-[#f5f9f8] text-[#313D52] rounded-lg border border-[#e0e6e5] hover:bg-[#e0e6e5] transition-colors",children:[(0,a.jsx)(i.A,{size:16,className:"mr-2"}),"Exportar"]}),(0,a.jsx)("button",{className:"inline-flex items-center px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",onClick:I,disabled:_,children:_?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.A,{size:16,className:"mr-2 animate-spin"}),"Actualizando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.A,{size:16,className:"mr-2"}),"Actualizar"]})})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,a.jsxs)("form",{onSubmit:t=>{t.preventDefault(),v(1),L(1,e)},className:"flex items-center relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(d.A,{size:18,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por nombre, tel\xe9fono o email...",value:e,onChange:e=>{t(e.target.value)},className:"w-full py-2 pl-10 pr-4 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm"})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] overflow-hidden",children:[D?(0,a.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,a.jsx)(r.A,{size:40,className:"animate-spin text-[#78f3d3]"})}):S?(0,a.jsxs)("div",{className:"text-center py-10 text-red-500",children:[(0,a.jsx)("p",{children:S}),(0,a.jsx)("button",{onClick:I,className:"mt-4 px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors",children:"Reintentar"})]}):0===g.length?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)(o.A,{size:48,className:"mx-auto text-[#e0e6e5] mb-4"}),(0,a.jsx)("p",{className:"text-[#6c7a89] font-medium",children:"No se encontraron clientes"}),(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Intenta con otros filtros o crea un nuevo cliente"}),(0,a.jsxs)(N(),{href:"/admin/clients/new",className:"inline-flex items-center px-4 py-2 mt-4 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors",children:[(0,a.jsx)(l.A,{size:16,className:"mr-2"}),"Nuevo Cliente"]})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-[#e0e6e5]",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Cliente"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Contacto"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Direcci\xf3n"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"\xd3rdenes"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Total Gastado"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Miembro desde"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-[#e0e6e5]",children:g.map(e=>{var t;return console.log("client",e),(0,a.jsxs)("tr",{className:"hover:bg-[#f5f9f8]",children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-10 w-10 bg-[#f5f9f8] rounded-full flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-[#313D52] font-medium",children:[e.nombre.charAt(0),(null===(t=e.apellidos)||void 0===t?void 0:t.charAt(0))||""]})}),(0,a.jsxs)("div",{className:"ml-3",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-[#313D52]",children:[e.nombre," ",e.apellidos]}),(0,a.jsxs)("div",{className:"text-xs text-[#6c7a89]",children:["ID: ",e.cliente_id]})]})]})}),(0,a.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap",children:[(0,a.jsxs)("div",{className:"text-sm text-[#313D52] flex items-center",children:[(0,a.jsx)(x.A,{size:14,className:"mr-1 text-[#6c7a89]"}),e.telefono]}),(0,a.jsxs)("div",{className:"text-sm text-[#313D52] flex items-center",children:[(0,a.jsx)(m.A,{size:14,className:"mr-1 text-[#6c7a89]"}),e.email||"No registrado"]})]}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("div",{className:"text-sm text-[#313D52]",children:e.direccion?(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(h.A,{size:14,className:"mr-1 mt-0.5 text-[#6c7a89] flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{children:e.direccion}),(0,a.jsxs)("div",{className:"text-xs text-[#6c7a89]",children:[e.ciudad&&"".concat(e.ciudad,", "),e.estado&&"".concat(e.estado," "),e.codigo_postal]})]})]}):(0,a.jsx)("span",{className:"text-[#6c7a89]",children:"No registrada"})})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"text-sm text-[#313D52]",children:[e.total_ordenes||0," \xf3rdenes"]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-[#313D52]",children:H(e.total_gastado||0)})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"text-sm text-[#6c7a89] flex items-center",children:[(0,a.jsx)(p.A,{size:14,className:"mr-1"}),U(e.fecha_creacion)]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(N(),{href:"/admin/clients/".concat(e.cliente_id),className:"text-[#78f3d3] hover:text-[#4de0c0]",children:(0,a.jsx)(u.A,{size:18})}),(0,a.jsx)(N(),{href:"/admin/clients/".concat(e.cliente_id,"/edit"),className:"text-[#6c7a89] hover:text-[#313D52]",children:(0,a.jsx)(f.A,{size:18})})]})})]},e.cliente_id)})})]})}),!D&&!S&&g.length>0&&(0,a.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between border-t border-[#e0e6e5]",children:[(0,a.jsxs)("div",{className:"text-sm text-[#6c7a89]",children:["Mostrando ",(0,a.jsx)("span",{className:"font-medium",children:(s-1)*z+1})," a"," ",(0,a.jsx)("span",{className:"font-medium",children:Math.min(s*z,k)})," de"," ",(0,a.jsx)("span",{className:"font-medium",children:k})," clientes"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{if(s>1){let t=s-1;v(t),L(t,e)}},disabled:1===s,className:"p-2 rounded-lg ".concat(1===s?"text-[#e0e6e5] cursor-not-allowed":"text-[#313D52] hover:bg-[#f5f9f8]"),children:(0,a.jsx)(j.A,{size:20})}),(0,a.jsxs)("span",{className:"text-sm text-[#313D52]",children:["P\xe1gina ",(0,a.jsx)("span",{className:"font-medium",children:s})," de"," ",(0,a.jsx)("span",{className:"font-medium",children:A})]}),(0,a.jsx)("button",{onClick:()=>{if(s<A){let t=s+1;v(t),L(t,e)}},disabled:s===A,className:"p-2 rounded-lg ".concat(s===A?"text-[#e0e6e5] cursor-not-allowed":"text-[#313D52] hover:bg-[#f5f9f8]"),children:(0,a.jsx)(y.A,{size:20})})]})]})]})]})}},42355:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},47924:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},51154:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},53904:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},69074:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},91788:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},92657:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[95,8441,1684,7358],()=>t(13495)),_N_E=e.O()}]);