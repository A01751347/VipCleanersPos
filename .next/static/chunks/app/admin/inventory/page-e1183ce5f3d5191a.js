(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[17],{1243:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},7503:(e,t,s)=>{Promise.resolve().then(s.bind(s,53826))},13052:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},13717:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},37108:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},42355:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},47924:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},48293:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},51154:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},53826:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var a=s(95155),r=s(12115),c=s(1243),l=s(68500),i=s(84616),d=s(72713),n=s(91788),o=s(51154),x=s(53904),m=s(37108),h=s(48293),p=s(47924),u=s(66932),f=s(13717),j=s(42355),g=s(13052),y=s(6874),N=s.n(y);function v(){let[e,t]=(0,r.useState)(""),[s,y]=(0,r.useState)(""),[v,b]=(0,r.useState)(!1),[w,k]=(0,r.useState)(1),[A,S]=(0,r.useState)([]),[M,z]=(0,r.useState)([]),[D,_]=(0,r.useState)(0),[C,I]=(0,r.useState)(1),[E]=(0,r.useState)(20),[L,O]=(0,r.useState)(!0),[V,P]=(0,r.useState)(!1),[q,R]=(0,r.useState)(null),[U,F]=(0,r.useState)({totalItems:0,lowStockItems:0,outOfStockItems:0,totalValue:0}),H=async()=>{try{let e=await fetch("/api/admin/products?categories=true"),t=await e.json();z(t.categories||[])}catch(e){console.error("Error loading categories:",e)}},T=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;try{P(!0);let e="/api/admin/products?page=".concat(t,"&pageSize=").concat(E);a&&(e+="&categoryIdFilter=".concat(a)),r&&(e+="&onlyLowStock=true"),c&&(e+="&searchQuery=".concat(encodeURIComponent(c)));let s=await fetch(e);if(!s.ok)throw Error("Error al cargar el inventario");let l=await s.json();S(l.products||[]),_(l.total||0),I(l.totalPages||1),B(l.products||[]),R(null)}catch(e){console.error("Error fetching inventory:",e),R("Error al cargar el inventario. Intente nuevamente.")}finally{O(!1),P(!1)}},B=e=>{let t=e.filter(e=>e.stock>0&&e.stock<=e.stock_minimo).length,s=e.filter(e=>e.stock<=0).length,a=e.reduce((e,t)=>e+t.stock*t.precio,0);F({totalItems:e.length,lowStockItems:t,outOfStockItems:s,totalValue:a})};(0,r.useEffect)(()=>{H(),T()},[]);let X=()=>{T()},G=async()=>{try{let t=await fetch("/api/admin/inventory/export?category=".concat(s,"&lowStock=").concat(v,"&search=").concat(encodeURIComponent(e)));if(!t.ok)throw Error("Error al exportar");let a=await t.blob(),r=window.URL.createObjectURL(a),c=document.createElement("a");c.href=r,c.download="inventario_".concat(new Date().toISOString().split("T")[0],".csv"),document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(r),document.body.removeChild(c)}catch(e){console.error("Error al exportar:",e),alert("Error al exportar los datos")}},Q=e=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(e),Z=e=>e.stock<=0?(0,a.jsxs)("span",{className:"px-2 py-1 inline-flex items-center text-xs font-medium rounded-full bg-red-100 text-red-800",children:[(0,a.jsx)(c.A,{size:12,className:"mr-1"}),"Agotado"]}):e.stock<=e.stock_minimo?(0,a.jsxs)("span",{className:"px-2 py-1 inline-flex items-center text-xs font-medium rounded-full bg-yellow-100 text-yellow-800",children:[(0,a.jsx)(l.A,{size:12,className:"mr-1"}),"Stock bajo"]}):(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800",children:"Disponible"});return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-[#313D52]",children:"Gesti\xf3n de Inventario"}),(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Control de productos y existencias"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsxs)(N(),{href:"/admin/products/new",className:"inline-flex items-center px-4 py-2 bg-[#313D52] text-white rounded-lg hover:bg-[#3e4a61] transition-colors",children:[(0,a.jsx)(i.A,{size:16,className:"mr-2"}),"Nuevo Producto"]}),(0,a.jsxs)(N(),{href:"/admin/inventory/movements",className:"inline-flex items-center px-4 py-2 bg-[#f5f9f8] text-[#313D52] rounded-lg border border-[#e0e6e5] hover:bg-[#e0e6e5] transition-colors",children:[(0,a.jsx)(d.A,{size:16,className:"mr-2"}),"Movimientos"]}),(0,a.jsxs)("button",{onClick:G,className:"inline-flex items-center px-4 py-2 bg-[#f5f9f8] text-[#313D52] rounded-lg border border-[#e0e6e5] hover:bg-[#e0e6e5] transition-colors",children:[(0,a.jsx)(n.A,{size:16,className:"mr-2"}),"Exportar"]}),(0,a.jsx)("button",{className:"inline-flex items-center px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",onClick:X,disabled:V,children:V?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{size:16,className:"mr-2 animate-spin"}),"Actualizando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{size:16,className:"mr-2"}),"Actualizar"]})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Total Productos"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-[#313D52]",children:U.totalItems})]}),(0,a.jsx)("div",{className:"p-3 bg-[#f5f9f8] rounded-lg",children:(0,a.jsx)(m.A,{size:24,className:"text-[#313D52]"})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Stock Bajo"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:U.lowStockItems})]}),(0,a.jsx)("div",{className:"p-3 bg-yellow-50 rounded-lg",children:(0,a.jsx)(l.A,{size:24,className:"text-yellow-600"})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Sin Stock"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-red-600",children:U.outOfStockItems})]}),(0,a.jsx)("div",{className:"p-3 bg-red-50 rounded-lg",children:(0,a.jsx)(c.A,{size:24,className:"text-red-600"})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Valor Total"}),(0,a.jsx)("p",{className:"text-xl font-bold text-[#313D52]",children:Q(U.totalValue)})]}),(0,a.jsx)("div",{className:"p-3 bg-[#e0f7f0] rounded-lg",children:(0,a.jsx)(h.A,{size:24,className:"text-[#78f3d3]"})})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsx)("div",{className:"md:flex-1",children:(0,a.jsxs)("form",{onSubmit:t=>{t.preventDefault(),k(1),T(1,s,v,e)},className:"flex items-center relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(p.A,{size:18,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por nombre o c\xf3digo de barras...",value:e,onChange:e=>{t(e.target.value)},className:"w-full py-2 pl-10 pr-4 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm"})]})}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsxs)("select",{value:s,onChange:t=>{let s=t.target.value;y(s),k(1),T(1,s,v,e)},className:"py-2 px-4 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm",children:[(0,a.jsx)("option",{value:"",children:"Todas las categor\xedas"}),M.map(e=>(0,a.jsx)("option",{value:e.categoria_id,children:e.nombre},e.categoria_id))]})}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsxs)("button",{onClick:()=>{let t=!v;b(t),k(1),T(1,s,t,e)},className:"flex items-center px-4 py-2 rounded-lg border transition-colors ".concat(v?"bg-yellow-100 border-yellow-300 text-yellow-800":"bg-white border-[#e0e6e5] text-[#6c7a89] hover:bg-[#f5f9f8]"),children:[(0,a.jsx)(u.A,{size:16,className:"mr-2"}),"Solo stock bajo"]})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] overflow-hidden",children:[L?(0,a.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,a.jsx)(o.A,{size:40,className:"animate-spin text-[#78f3d3]"})}):q?(0,a.jsxs)("div",{className:"text-center py-10 text-red-500",children:[(0,a.jsx)("p",{children:q}),(0,a.jsx)("button",{onClick:X,className:"mt-4 px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors",children:"Reintentar"})]}):0===A.length?(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)(m.A,{size:48,className:"mx-auto text-[#e0e6e5] mb-4"}),(0,a.jsx)("p",{className:"text-[#6c7a89] font-medium",children:"No se encontraron productos"}),(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Intenta con otros filtros o agrega un nuevo producto"}),(0,a.jsxs)(N(),{href:"/admin/products/new",className:"inline-flex items-center px-4 py-2 mt-4 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors",children:[(0,a.jsx)(i.A,{size:16,className:"mr-2"}),"Nuevo Producto"]})]}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-[#e0e6e5]",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Producto"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Categor\xeda"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"C\xf3digo"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Precio"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Stock"}),(0,a.jsx)("th",{className:"px-4 py-3 text-center text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Stock M\xednimo"}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Estado"}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-[#e0e6e5]",children:A.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-[#f5f9f8]",children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-[#313D52]",children:e.nombre}),e.descripcion&&(0,a.jsx)("div",{className:"text-xs text-[#6c7a89]",children:e.descripcion})]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-[#6c7a89]",children:e.categoria}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-mono text-[#6c7a89]",children:e.codigo_barras||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-[#313D52]",children:Q(e.precio)}),e.precio_oferta&&(0,a.jsxs)("div",{className:"text-xs text-green-600",children:["Oferta: ",Q(e.precio_oferta)]})]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:(0,a.jsx)("span",{className:"text-sm font-medium ".concat(e.stock<=0?"text-red-600":e.stock<=e.stock_minimo?"text-yellow-600":"text-[#313D52]"),children:e.stock})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-center text-sm text-[#6c7a89]",children:e.stock_minimo}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:Z(e)}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsx)(N(),{href:"/admin/products/".concat(e.producto_id,"/edit"),className:"text-[#78f3d3] hover:text-[#4de0c0]",children:(0,a.jsx)(f.A,{size:18})})})]},e.producto_id))})]})}),!L&&!q&&A.length>0&&(0,a.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between border-t border-[#e0e6e5]",children:[(0,a.jsxs)("div",{className:"text-sm text-[#6c7a89]",children:["Mostrando ",(0,a.jsx)("span",{className:"font-medium",children:(w-1)*E+1})," a"," ",(0,a.jsx)("span",{className:"font-medium",children:Math.min(w*E,D)})," de"," ",(0,a.jsx)("span",{className:"font-medium",children:D})," productos"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{if(w>1){let e=w-1;k(e),T(e)}},disabled:1===w,className:"p-2 rounded-lg ".concat(1===w?"text-[#e0e6e5] cursor-not-allowed":"text-[#313D52] hover:bg-[#f5f9f8]"),children:(0,a.jsx)(j.A,{size:20})}),(0,a.jsxs)("span",{className:"text-sm text-[#313D52]",children:["P\xe1gina ",(0,a.jsx)("span",{className:"font-medium",children:w})," de"," ",(0,a.jsx)("span",{className:"font-medium",children:C})]}),(0,a.jsx)("button",{onClick:()=>{if(w<C){let e=w+1;k(e),T(e)}},disabled:w===C,className:"p-2 rounded-lg ".concat(w===C?"text-[#e0e6e5] cursor-not-allowed":"text-[#313D52] hover:bg-[#f5f9f8]"),children:(0,a.jsx)(g.A,{size:20})})]})]})]})]})}},53904:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},66932:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},68500:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]])},72713:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},84616:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},91788:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[95,8441,1684,7358],()=>t(7503)),_N_E=e.O()}]);