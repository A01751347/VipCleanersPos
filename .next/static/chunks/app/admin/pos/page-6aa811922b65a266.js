(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2667],{33302:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>$});var a=s(95155),r=s(12115),l=s(47924),i=s(12318),n=s(62525),o=s(27809),c=s(54416),d=s(85339),m=s(51154),x=s(81586),u=s(9446);let f=e=>{let{onSelectClient:t,selectedClient:s}=e,[i,n]=(0,r.useState)(""),[o,c]=(0,r.useState)([]),[d,x]=(0,r.useState)(!1),[f,p]=(0,r.useState)(!1),h=(0,r.useRef)(null);(0,r.useEffect)(()=>{function e(e){h.current&&!h.current.contains(e.target)&&p(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,r.useEffect)(()=>{let e=async()=>{if(i.length<3){c([]);return}try{x(!0);let e=await fetch("/api/admin/clients?search=".concat(encodeURIComponent(i)));if(!e.ok)throw Error("Error al buscar clientes");let t=await e.json();c(t.clients||[]),p(t.clients&&t.clients.length>0)}catch(e){console.error("Error al buscar clientes:",e),c([])}finally{x(!1)}},t=setTimeout(()=>{i.length>=3&&e()},300);return()=>clearTimeout(t)},[i]);let b=e=>{t(e),p(!1),n("")};return(0,a.jsxs)("div",{ref:h,className:"relative",children:[s?(0,a.jsxs)("div",{className:"bg-white p-3 rounded-lg border border-[#e0e6e5] flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"font-medium text-[#313D52]",children:[s.nombre," ",s.apellidos||""]}),(0,a.jsxs)("div",{className:"text-sm text-[#6c7a89]",children:[s.telefono," ",s.email?"• ".concat(s.email):""]})]}),(0,a.jsx)("button",{onClick:()=>{t(null)},className:"p-1 hover:bg-red-50 rounded text-red-500",children:(0,a.jsx)(u.A,{size:18})})]}):(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(l.A,{size:16,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar cliente por nombre, tel\xe9fono o email...",value:i,onChange:e=>n(e.target.value),onFocus:()=>{i.length>=3&&o.length>0&&p(!0)},className:"w-full pl-10 pr-4 py-3 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"}),d&&(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,a.jsx)(m.A,{size:16,className:"animate-spin text-[#78f3d3]"})}),f&&(0,a.jsx)("div",{className:"absolute z-10 w-full mt-1 bg-white rounded-lg border border-[#e0e6e5] shadow-lg max-h-80 overflow-y-auto",children:o.length>0?(0,a.jsx)("ul",{children:o.map((e,t)=>{var s,r,l,i;let n=null!==(i=null===(s=e.id)||void 0===s?void 0:s.toString())&&void 0!==i?i:"".concat(null!==(r=e.telefono)&&void 0!==r?r:"","-").concat(null!==(l=e.email)&&void 0!==l?l:"","-").concat(t);return(0,a.jsx)("li",{children:(0,a.jsxs)("button",{onClick:()=>b(e),className:"w-full text-left px-4 py-3 hover:bg-[#f5f9f8] border-b border-[#e0e6e5] last:border-b-0",children:[(0,a.jsxs)("div",{className:"font-medium text-[#313D52]",children:[e.nombre," ",e.apellidos||""]}),(0,a.jsxs)("div",{className:"text-sm text-[#6c7a89]",children:[e.telefono," ",e.email?"• ".concat(e.email):""]})]})},n)})}):(0,a.jsx)("div",{className:"py-4 px-4 text-center text-[#6c7a89]",children:(0,a.jsx)("p",{children:"No se encontraron resultados"})})})]}),i.length>0&&i.length<3&&(0,a.jsx)("p",{className:"mt-1 text-xs text-[#6c7a89]",children:"Ingresa al menos 3 caracteres para buscar"})]})};var p=s(37108),h=s(43332),b=s(49103),g=s(66932);let j=e=>{let{onAddToCart:t,searchTerm:s}=e,[l,i]=(0,r.useState)([]),[n,o]=(0,r.useState)([]),[c,x]=(0,r.useState)(null),[u,f]=(0,r.useState)(!0),[j,v]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{f(!0),v(null);let e=await fetch("/api/admin/products?categories=true");if(!e.ok)throw Error("Error al cargar categor\xedas");let t=await e.json();i(t.categories||[]),t.categories&&t.categories.length>0&&x(t.categories[0].categoria_id)}catch(e){console.error("Error fetching categories:",e),v("No se pudieron cargar las categor\xedas de productos")}finally{f(!1)}})()},[]),(0,r.useEffect)(()=>{let e=async()=>{if(null!==c)try{f(!0),v(null);let e=await fetch("/api/admin/products?categoryId=".concat(c));if(!e.ok)throw Error("Error al cargar productos");let t=await e.json();o(t.products||[])}catch(e){console.error("Error fetching products:",e),v("No se pudieron cargar los productos")}finally{f(!1)}},t=async()=>{if(s&&!(s.length<3))try{f(!0),v(null);let e=await fetch("/api/admin/products?search=".concat(encodeURIComponent(s)));if(!e.ok)throw Error("Error al buscar productos");let t=await e.json();o(t.products||[]),x(null)}catch(e){console.error("Error searching products:",e),v("No se pudieron buscar los productos")}finally{f(!1)}};s&&s.length>=3?t():null!==c&&e()},[c,s]);let N=e=>{x(e)},y=e=>{t({id:e.producto_id,tipo:"producto",nombre:e.nombre,precio:e.precio_oferta||e.precio,cantidad:1})},w=e=>e.estado_stock?(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat({Disponible:"bg-green-100 text-green-800",Bajo:"bg-yellow-100 text-yellow-800",Agotado:"bg-red-100 text-red-800"}[e.estado_stock]),children:e.estado_stock}):null;return u&&0===l.length?(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(m.A,{size:40,className:"animate-spin text-[#78f3d3]"})}):j&&0===l.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,a.jsx)(d.A,{size:40,className:"text-red-500 mb-4"}),(0,a.jsx)("p",{className:"text-[#313D52]",children:j}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg",children:"Reintentar"})]}):(0,a.jsxs)("div",{children:[(!s||s.length<3)&&(0,a.jsx)("div",{className:"mb-6 overflow-x-auto pb-2",children:(0,a.jsx)("div",{className:"flex space-x-2",children:l.map(e=>(0,a.jsx)("button",{onClick:()=>N(e.categoria_id),className:"px-4 py-2 rounded-lg whitespace-nowrap ".concat(c===e.categoria_id?"bg-[#78f3d3] text-[#313D52] font-medium":"bg-[#f5f9f8] text-[#6c7a89] hover:bg-[#e0e6e5]"),children:e.nombre},e.categoria_id))})}),s&&s.length>=3&&(0,a.jsxs)("div",{className:"mb-4 flex items-center text-sm text-[#6c7a89]",children:[(0,a.jsx)(g.A,{size:16,className:"mr-1"}),"Resultados para: ",(0,a.jsxs)("span",{className:"font-medium ml-1",children:['"',s,'"']}),null===c&&u&&(0,a.jsx)(m.A,{size:16,className:"ml-2 animate-spin text-[#78f3d3]"})]}),u&&null!==c?(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)(m.A,{size:32,className:"animate-spin text-[#78f3d3]"})}):0===n.length?(0,a.jsx)("div",{className:"text-center py-8 text-[#6c7a89]",children:(0,a.jsx)("p",{children:"No se encontraron productos"})}):(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:n.map(e=>{let t=e.stock<=0;return(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-[#e0e6e5] hover:shadow-md transition-shadow ".concat(t?"opacity-50":""),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium text-[#313D52] flex items-center",children:[(0,a.jsx)(p.A,{size:18,className:"mr-2"}),e.nombre]}),e.descripcion?(0,a.jsx)("p",{className:"text-sm text-[#6c7a89] mt-1",children:e.descripcion}):null,(0,a.jsxs)("div",{className:"flex items-center mt-2 space-x-2",children:[w(e),e.categoria_nombre?(0,a.jsxs)("span",{className:"text-xs bg-[#f5f9f8] text-[#6c7a89] px-2 py-1 rounded flex items-center",children:[(0,a.jsx)(h.A,{size:12,className:"mr-1"}),e.categoria_nombre]}):null]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-bold text-[#313D52]",children:["$",(Number(e.precio_oferta)||Number(e.precio)).toFixed(2)]}),e.precio_oferta?(0,a.jsxs)("div",{className:"text-xs text-[#6c7a89] line-through",children:["$",e.precio.toFixed(2)]}):null]})]}),(0,a.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"text-sm text-[#6c7a89]",children:[(0,a.jsx)("span",{className:"font-medium",children:"Stock:"})," ",e.stock]}),(0,a.jsxs)("button",{onClick:()=>y(e),disabled:t,className:"flex items-center text-sm rounded-lg px-3 py-1 ".concat(t?"bg-[#f5f9f8] text-[#6c7a89] cursor-not-allowed":"bg-[#f5f9f8] text-[#313D52] hover:bg-[#e0e6e5]"),children:[(0,a.jsx)(b.A,{size:16,className:"mr-1 ".concat(t?"text-[#6c7a89]":"text-[#78f3d3]")}),t?"Sin stock":"Agregar"]})]})]},e.producto_id)})})]})};var v=s(75525),N=s(76028);let y=e=>{let{onAddToCart:t,searchTerm:s}=e,[l,i]=(0,r.useState)([]),[n,o]=(0,r.useState)(!0),[c,x]=(0,r.useState)(null),[u,f]=(0,r.useState)(!1),[p,h]=(0,r.useState)(null),[g,j]=(0,r.useState)(""),[y,w]=(0,r.useState)(""),[C,k]=(0,r.useState)("");(0,r.useEffect)(()=>{(async()=>{try{o(!0),x(null);let e=await fetch("/api/admin/services");if(!e.ok)throw Error("Error al cargar servicios");let t=await e.json();i(t.services||[])}catch(e){console.error("Error fetching services:",e),x("No se pudieron cargar los servicios")}finally{o(!1)}})()},[]);let S=l.filter(e=>e.nombre.toLowerCase().includes(s.toLowerCase())||e.descripcion.toLowerCase().includes(s.toLowerCase())),A=e=>{h(e),f(!0)};return n?(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(m.A,{size:40,className:"animate-spin text-[#78f3d3]"})}):c?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full",children:[(0,a.jsx)(d.A,{size:40,className:"text-red-500 mb-4"}),(0,a.jsx)("p",{className:"text-[#313D52]",children:c}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg",children:"Reintentar"})]}):(0,a.jsxs)("div",{children:[0===S.length?(0,a.jsx)("div",{className:"text-center py-8 text-[#6c7a89]",children:(0,a.jsx)("p",{children:"No se encontraron servicios"})}):(0,a.jsx)("div",{className:"grid grid-cols-1 gap-4",children:S.map(e=>(0,a.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-[#e0e6e5] hover:shadow-md transition-shadow",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-medium text-[#313D52] flex items-center",children:[e.nombre.toLowerCase().includes("premium")?(0,a.jsx)(v.A,{size:18,className:"mr-2"}):(0,a.jsx)(N.A,{size:18,className:"mr-2"}),e.nombre]}),(0,a.jsx)("p",{className:"text-sm text-[#6c7a89] mt-1",children:e.descripcion}),e.requiere_identificacion?(0,a.jsxs)("div",{className:"mt-2 text-xs text-amber-700 bg-amber-50 px-2 py-1 rounded inline-flex items-center",children:[(0,a.jsx)(d.A,{size:12,className:"mr-1"}),"Requiere identificaci\xf3n"]}):null]}),(0,a.jsxs)("div",{className:"text-[#313D52] font-bold",children:["$",Number(e.precio).toFixed(2)]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsxs)("button",{onClick:()=>A(e),className:"flex items-center text-sm text-[#313D52] bg-[#f5f9f8] hover:bg-[#e0e6e5] rounded-lg px-3 py-1",children:[(0,a.jsx)(b.A,{size:16,className:"mr-1 text-[#78f3d3]"}),"Agregar"]})})]},e.servicio_id))}),u&&p&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("h2",{className:"text-lg font-semibold text-[#313D52] mb-4",children:["Detalles del Calzado para ",p.nombre]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"brand",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Marca"}),(0,a.jsx)("input",{id:"brand",type:"text",value:g,onChange:e=>j(e.target.value),placeholder:"Ej. Nike, Adidas, etc.",className:"w-full px-3 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"model",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Modelo"}),(0,a.jsx)("input",{id:"model",type:"text",value:y,onChange:e=>w(e.target.value),placeholder:"Ej. Air Force 1, Yeezy, etc.",className:"w-full px-3 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Descripci\xf3n Adicional"}),(0,a.jsx)("textarea",{id:"description",value:C,onChange:e=>k(e.target.value),placeholder:"Color, tama\xf1o, detalles especiales...",rows:3,className:"w-full px-3 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] resize-none"})]})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,a.jsx)("button",{onClick:()=>f(!1),className:"px-4 py-2 border border-[#e0e6e5] text-[#6c7a89] rounded-lg hover:bg-[#f5f9f8]",children:"Cancelar"}),(0,a.jsx)("button",{onClick:()=>{p&&(t({id:p.servicio_id,tipo:"servicio",nombre:p.nombre,precio:p.precio,cantidad:1,marca:g||void 0,modelo:y||void 0,descripcion:C||void 0}),f(!1),h(null),j(""),w(""),k(""))},className:"px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0]",children:"Agregar al Carrito"})]})]})})})]})},w=e=>{let{subtotal:t,iva:s,total:r}=e,l=e=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(e||0);return console.log("\uD83D\uDCCA CartSummary (IVA incluido) recibi\xf3:",{subtotal:t,iva:s,total:r}),(0,a.jsxs)("div",{className:"bg-[#f5f9f8] p-4 rounded-lg",children:[(0,a.jsx)("h3",{className:"font-medium text-[#313D52] mb-3",children:"Resumen de la Orden"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-[#6c7a89]",children:"Subtotal (sin IVA):"}),(0,a.jsx)("span",{className:"text-[#313D52] font-medium",children:l(t)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-[#6c7a89]",children:"IVA (16%):"}),(0,a.jsx)("span",{className:"text-[#313D52] font-medium",children:l(s)})]}),(0,a.jsx)("div",{className:"border-t border-[#e0e6e5] pt-2 mt-3",children:(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{className:"font-semibold text-[#313D52]",children:"Total:"}),(0,a.jsx)("span",{className:"font-bold text-lg text-[#313D52]",children:l(r)})]})})]})]})};var C=s(55868),k=s(53904),S=s(46767);let A=e=>{let{total:t,onSubmit:s,onCancel:l}=e,[i,n]=(0,r.useState)("efectivo"),[o,c]=(0,r.useState)(t.toFixed(2)),[d,u]=(0,r.useState)(""),[f,p]=(0,r.useState)(""),[h,b]=(0,r.useState)(0),[g,j]=(0,r.useState)(!1),[v,N]=(0,r.useState)({}),y=e=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:2}).format(e),w=e=>{n(e),u(""),p(""),"efectivo"!==e&&(c(t.toFixed(2)),b(0))};return(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault();let a={},r=parseFloat(o);if(!o||isNaN(r)?a.amount="Ingresa un monto v\xe1lido":r<=0?a.amount="El monto debe ser mayor a 0":"efectivo"!==i&&r!==t?(a.amount="El monto debe ser igual al total",c(t.toFixed(2))):"efectivo"===i&&r<t&&(a.amount="El monto debe ser al menos igual al total"),"transferencia"!==i||d.trim()||(a.reference="Ingresa una referencia"),"tarjeta"!==i||f.trim()||(a.terminalId="Selecciona una terminal"),Object.keys(a).length>0){N(a);return}j(!0),setTimeout(()=>{s({metodoPago:i,monto:r,referencia:d||void 0,terminalId:f||void 0}),j(!1)},1e3)},className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"text-sm text-[#6c7a89]",children:"Total a pagar"}),(0,a.jsx)("div",{className:"text-3xl font-bold text-[#313D52]",children:y(t)})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-[#6c7a89] mb-2",children:"M\xe9todo de pago"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>w("efectivo"),className:"p-3 rounded-lg flex items-center justify-center border ".concat("efectivo"===i?"bg-[#e0f7f0] border-[#78f3d3] text-[#313D52]":"border-[#e0e6e5] text-[#6c7a89] hover:bg-[#f5f9f8]"),children:[(0,a.jsx)(C.A,{size:20,className:"mr-2"}),"Efectivo"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>w("tarjeta"),className:"p-3 rounded-lg flex items-center justify-center border ".concat("tarjeta"===i?"bg-[#e0f7f0] border-[#78f3d3] text-[#313D52]":"border-[#e0e6e5] text-[#6c7a89] hover:bg-[#f5f9f8]"),children:[(0,a.jsx)(x.A,{size:20,className:"mr-2"}),"Tarjeta"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>w("transferencia"),className:"p-3 rounded-lg flex items-center justify-center border ".concat("transferencia"===i?"bg-[#e0f7f0] border-[#78f3d3] text-[#313D52]":"border-[#e0e6e5] text-[#6c7a89] hover:bg-[#f5f9f8]"),children:[(0,a.jsx)(k.A,{size:20,className:"mr-2"}),"Transferencia"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>w("mercado_pago"),className:"p-3 rounded-lg flex items-center justify-center border ".concat("mercado_pago"===i?"bg-[#e0f7f0] border-[#78f3d3] text-[#313D52]":"border-[#e0e6e5] text-[#6c7a89] hover:bg-[#f5f9f8]"),children:[(0,a.jsx)(S.A,{size:20,className:"mr-2"}),"Mercado Pago"]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"efectivo"===i?"Monto recibido":"Monto a cobrar"}),(0,a.jsxs)("div",{className:"mt-1 relative rounded-md shadow-sm",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-[#6c7a89] sm:text-sm",children:"$"})}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"efectivo"===i?t:void 0,id:"amount",value:o,onChange:e=>{let s=e.target.value;if(c(s),"efectivo"===i){let e=parseFloat(s)||0;b(e>t?e-t:0)}v.amount&&N({...v,amount:""})},className:"block w-full pl-8 pr-12 py-3 rounded-lg border ".concat(v.amount?"border-red-300 bg-red-50":"border-[#e0e6e5]"," focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"),placeholder:"0.00",readOnly:"efectivo"!==i}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-[#6c7a89] sm:text-sm",children:"MXN"})})]}),v.amount&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-500",children:v.amount}),"efectivo"===i&&parseFloat(o)>t&&(0,a.jsxs)("div",{className:"mt-2 text-[#313D52] font-medium flex justify-end",children:[(0,a.jsx)("span",{className:"text-[#6c7a89] mr-2",children:"Cambio:"})," ",y(h)]})]}),"transferencia"===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"reference",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Referencia de transferencia"}),(0,a.jsx)("input",{type:"text",id:"reference",value:d,onChange:e=>{u(e.target.value),v.reference&&N({...v,reference:""})},className:"w-full px-4 py-3 rounded-lg border ".concat(v.reference?"border-red-300 bg-red-50":"border-[#e0e6e5]"," focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"),placeholder:"N\xfamero o ID de transferencia"}),v.reference&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-500",children:v.reference})]}),"tarjeta"===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"terminalId",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Terminal"}),(0,a.jsxs)("select",{id:"terminalId",value:f,onChange:e=>{p(e.target.value),v.terminalId&&N({...v,terminalId:""})},className:"w-full px-4 py-3 rounded-lg border ".concat(v.terminalId?"border-red-300 bg-red-50":"border-[#e0e6e5]"," focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"),children:[(0,a.jsx)("option",{value:"",children:"Seleccionar terminal..."}),(0,a.jsx)("option",{value:"1",children:"Terminal Principal"}),(0,a.jsx)("option",{value:"2",children:"Terminal Secundaria"})]}),v.terminalId&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-500",children:v.terminalId})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:l,disabled:g,className:"px-4 py-2 border border-[#e0e6e5] text-[#6c7a89] rounded-lg hover:bg-[#f5f9f8] transition-colors",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:g,className:"px-6 py-2 bg-[#78f3d3] text-[#313D52] font-medium rounded-lg hover:bg-[#4de0c0] transition-colors flex items-center",children:g?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{size:18,className:"animate-spin mr-2"}),"Procesando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{size:18,className:"mr-2"}),"Completar Pago"]})})]})]})};var D=s(71007),E=s(19420),I=s(28883),z=s(4516);let F=e=>{let{onSubmit:t,onCancel:s}=e,[l,i]=(0,r.useState)({nombre:"",apellidos:"",telefono:"",email:"",direccion:"",codigo_postal:"",ciudad:"",estado:""}),[n,o]=(0,r.useState)({}),[c,x]=(0,r.useState)(!1),[u,f]=(0,r.useState)(null),p=e=>{let{name:t,value:s}=e.target;i({...l,[t]:s}),n[t]&&o({...n,[t]:""})},h=()=>{let e={};return l.nombre.trim()||(e.nombre="El nombre es obligatorio"),l.telefono?/^\d{10}$/.test(l.telefono.replace(/\D/g,""))||(e.telefono="Ingresa un n\xfamero de tel\xe9fono v\xe1lido (10 d\xedgitos)"):e.telefono="El tel\xe9fono es obligatorio",l.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)&&(e.email="Ingresa un email v\xe1lido"),l.codigo_postal&&!/^\d{5}$/.test(l.codigo_postal)&&(e.codigo_postal="El c\xf3digo postal debe tener 5 d\xedgitos"),o(e),0===Object.keys(e).length},b=async e=>{if(e.preventDefault(),h()){x(!0),f(null);try{let e=await fetch("/api/admin/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),s=await e.json();if(!e.ok)throw Error(s.error||"Error al crear el cliente");t({...l,id:s.clientId})}catch(e){console.error("Error al crear cliente:",e),f(e instanceof Error?e.message:"Error al crear el cliente")}finally{x(!1)}}};return(0,a.jsxs)("form",{onSubmit:b,className:"p-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"nombre",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Nombre *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(D.A,{size:16,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"text",id:"nombre",name:"nombre",value:l.nombre,onChange:p,className:"w-full pl-10 pr-4 py-2 rounded-lg border ".concat(n.nombre?"border-red-300 bg-red-50":"border-[#e0e6e5]"," focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"),placeholder:"Nombre del cliente"})]}),n.nombre&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-500",children:n.nombre})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"apellidos",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Apellidos"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(D.A,{size:16,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"text",id:"apellidos",name:"apellidos",value:l.apellidos,onChange:p,className:"w-full pl-10 pr-4 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3]",placeholder:"Apellidos (opcional)"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"telefono",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Tel\xe9fono *"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(E.A,{size:16,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"tel",id:"telefono",name:"telefono",value:l.telefono,onChange:p,className:"w-full pl-10 pr-4 py-2 rounded-lg border ".concat(n.telefono?"border-red-300 bg-red-50":"border-[#e0e6e5]"," focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"),placeholder:"10 d\xedgitos"})]}),n.telefono&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-500",children:n.telefono})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Email"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(I.A,{size:16,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"email",id:"email",name:"email",value:l.email,onChange:p,className:"w-full pl-10 pr-4 py-2 rounded-lg border ".concat(n.email?"border-red-300 bg-red-50":"border-[#e0e6e5]"," focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"),placeholder:"correo@ejemplo.com (opcional)"})]}),n.email&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-500",children:n.email})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"direccion",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Direcci\xf3n"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(z.A,{size:16,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"text",id:"direccion",name:"direccion",value:l.direccion,onChange:p,className:"w-full pl-10 pr-4 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3]",placeholder:"Calle, n\xfamero, colonia (opcional)"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"codigo_postal",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"C\xf3digo Postal"}),(0,a.jsx)("input",{type:"text",id:"codigo_postal",name:"codigo_postal",value:l.codigo_postal,onChange:p,className:"w-full px-4 py-2 rounded-lg border ".concat(n.codigo_postal?"border-red-300 bg-red-50":"border-[#e0e6e5]"," focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"),placeholder:"5 d\xedgitos"}),n.codigo_postal&&(0,a.jsx)("p",{className:"mt-1 text-xs text-red-500",children:n.codigo_postal})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"ciudad",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Ciudad"}),(0,a.jsx)("input",{type:"text",id:"ciudad",name:"ciudad",value:l.ciudad,onChange:p,className:"w-full px-4 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3]",placeholder:"Ciudad (opcional)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"estado",className:"block text-sm font-medium text-[#6c7a89] mb-1",children:"Estado"}),(0,a.jsx)("input",{type:"text",id:"estado",name:"estado",value:l.estado,onChange:p,className:"w-full px-4 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3]",placeholder:"Estado (opcional)"})]})]})]}),u&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-red-50 text-red-600 rounded-lg flex items-start",children:[(0,a.jsx)(d.A,{size:16,className:"mt-0.5 mr-2 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm",children:u})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:s,disabled:c,className:"px-4 py-2 border border-[#e0e6e5] text-[#6c7a89] rounded-lg hover:bg-[#f5f9f8] transition-colors",children:"Cancelar"}),(0,a.jsx)("button",{type:"submit",disabled:c,className:"px-6 py-2 bg-[#78f3d3] text-[#313D52] font-medium rounded-lg hover:bg-[#4de0c0] transition-colors flex items-center",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{size:18,className:"animate-spin mr-2"}),"Guardando..."]}):"Guardar Cliente"})]})]})};var _=s(6874),T=s.n(_),P=s(40646),O=s(29869),L=s(81304),M=s(57434);let q=e=>{let{ordenId:t,codigoOrden:s,requiereIdentificacion:l,onStartNew:i}=e,[n,o]=(0,r.useState)(!1),[c,x]=(0,r.useState)(!1),[u,f]=(0,r.useState)(null),p=async e=>{o(!0),f(null);try{let s=new FormData;s.append("file",e),s.append("tipo","identificacion"),s.append("entidadTipo","orden"),s.append("entidadId",t.toString());let a=await fetch("/api/admin/upload",{method:"POST",body:s}),r=await a.json();if(!a.ok)throw Error(r.error||"Error al subir la identificaci\xf3n");x(!0)}catch(e){console.error("Error al subir identificaci\xf3n:",e),f(e instanceof Error?e.message:"Error al subir la identificaci\xf3n")}finally{o(!1)}};return(0,a.jsxs)("div",{className:"max-w-md mx-auto bg-white p-6 rounded-xl shadow-lg",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center text-center mb-6",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-[#e0f7f0] rounded-full flex items-center justify-center mb-4",children:(0,a.jsx)(P.A,{size:40,className:"text-[#78f3d3]"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-[#313D52]",children:"\xa1Orden Creada con \xc9xito!"}),(0,a.jsx)("p",{className:"mt-2 text-[#6c7a89]",children:"La orden ha sido registrada correctamente en el sistema."})]}),(0,a.jsxs)("div",{className:"bg-[#f5f9f8] p-6 rounded-lg mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("span",{className:"text-[#6c7a89] font-medium",children:"C\xf3digo de Orden:"}),(0,a.jsx)("span",{className:"text-xl font-bold text-[#313D52]",children:s})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-[#6c7a89] font-medium",children:"Orden ID:"}),(0,a.jsx)("span",{className:"text-[#313D52] font-medium",children:t})]})]}),l&&!c&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("div",{className:"p-4 rounded-lg ".concat(u?"bg-red-50":"bg-amber-50"," mb-4"),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(d.A,{size:20,className:"mr-2 flex-shrink-0 ".concat(u?"text-red-500":"text-amber-500")}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium ".concat(u?"text-red-700":"text-amber-700"),children:u?"Error al subir identificaci\xf3n":"Identificaci\xf3n requerida"}),(0,a.jsx)("p",{className:"text-sm mt-1 ".concat(u?"text-red-600":"text-amber-600"),children:u||"Esta orden requiere una identificaci\xf3n oficial del cliente."})]})]})}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-[#e0e6e5] rounded-lg p-6 text-center",children:[(0,a.jsx)(O.A,{size:32,className:"mx-auto mb-2 text-[#6c7a89]"}),(0,a.jsx)("p",{className:"text-[#313D52] font-medium mb-2",children:"Subir Identificaci\xf3n"}),(0,a.jsx)("p",{className:"text-sm text-[#6c7a89] mb-4",children:"Sube una fotograf\xeda o escaneo de la identificaci\xf3n oficial del cliente. Solo archivos JPG, JPEG o PNG, m\xe1ximo 5MB."}),(0,a.jsxs)("label",{className:"inline-flex items-center px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors cursor-pointer",children:[n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{size:18,className:"animate-spin mr-2"}),"Subiendo..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O.A,{size:18,className:"mr-2"}),"Seleccionar Archivo"]}),(0,a.jsx)("input",{type:"file",className:"hidden",accept:"image/jpeg,image/jpg,image/png",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s){if(!["image/jpeg","image/jpg","image/png"].includes(s.type)){f("Solo se permiten archivos de imagen (JPEG, JPG, PNG)");return}if(s.size>5242880){f("El archivo no debe superar los 5MB");return}p(s)}},disabled:n})]})]})]}),l&&c&&(0,a.jsx)("div",{className:"p-4 bg-green-50 rounded-lg mb-6",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(P.A,{size:20,className:"mr-2 flex-shrink-0 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-green-700",children:"Identificaci\xf3n subida correctamente"}),(0,a.jsx)("p",{className:"text-sm mt-1 text-green-600",children:"La identificaci\xf3n del cliente se ha registrado en el sistema."})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>{console.log("Imprimiendo ticket para la orden ".concat(s)),window.open("/admin/orders/".concat(t,"/print"),"_blank")},className:"w-full py-3 bg-[#313D52] text-white rounded-lg flex items-center justify-center font-medium hover:bg-[#3e4a61] transition-colors",children:[(0,a.jsx)(L.A,{size:20,className:"mr-2"}),"Imprimir Ticket"]}),(0,a.jsxs)(T(),{href:"/admin/orders/".concat(t),className:"w-full py-3 border border-[#e0e6e5] text-[#313D52] rounded-lg flex items-center justify-center font-medium hover:bg-[#f5f9f8] transition-colors",children:[(0,a.jsx)(M.A,{size:20,className:"mr-2"}),"Ver Detalles de la Orden"]}),(0,a.jsxs)("button",{onClick:i,className:"w-full py-3 bg-[#78f3d3] text-[#313D52] rounded-lg flex items-center justify-center font-medium hover:bg-[#4de0c0] transition-colors",children:[(0,a.jsx)(k.A,{size:20,className:"mr-2"}),"Nueva Venta"]})]})]})};function $(){let[e,t]=(0,r.useState)([]),[s,u]=(0,r.useState)(null),[p,h]=(0,r.useState)(""),[b,g]=(0,r.useState)(!1),[v,N]=(0,r.useState)([]),[C,k]=(0,r.useState)("servicios"),[S,D]=(0,r.useState)(!1),[E,I]=(0,r.useState)(!1),[z,_]=(0,r.useState)(""),[T,P]=(0,r.useState)(!1),[O,L]=(0,r.useState)(null),[M,$]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{let e=await fetch("/api/admin/services");N((await e.json()).services||[])})()},[]);let R=()=>e.reduce((e,t)=>e+("string"==typeof t.precio?parseFloat(t.precio):t.precio||0)*("string"==typeof t.cantidad?parseInt(t.cantidad,10):t.cantidad||0),0),G=()=>R()/1.16,V=()=>R(),J=()=>{let t=e.filter(e=>"servicio"===e.tipo),s=e.filter(e=>"producto"===e.tipo),a=t.reduce((e,t)=>e+("string"==typeof t.precio?parseFloat(t.precio):t.precio||0)*("string"==typeof t.cantidad?parseInt(t.cantidad,10):t.cantidad||0),0),r=s.reduce((e,t)=>e+("string"==typeof t.precio?parseFloat(t.precio):t.precio||0)*("string"==typeof t.cantidad?parseInt(t.cantidad,10):t.cantidad||0),0),l=a/1.16,i=r/1.16,n=a-l,o=r-i;return{subtotalServicios:l,subtotalProductos:i,subtotalTotal:l+i,ivaServicios:n,ivaProductos:o,ivaTotal:n+o,totalConIvaTotal:a+r}};e.some(e=>"servicio"===e.tipo&&2===e.id);let X=s=>{if("producto"===s.tipo){let a=e.findIndex(e=>e.id===s.id&&e.tipo===s.tipo);if(a>=0){let r=[...e];r[a].cantidad+=s.cantidad,t(r)}else t([...e,s]);return}if("servicio"===s.tipo&&(s.marca||s.modelo||s.descripcion)){e.some(e=>{var t,a,r,l,i,n;return"servicio"===e.tipo&&(null===(t=e.marca)||void 0===t?void 0:t.trim().toLowerCase())===(null===(a=s.marca)||void 0===a?void 0:a.trim().toLowerCase())&&(null===(r=e.modelo)||void 0===r?void 0:r.trim().toLowerCase())===(null===(l=s.modelo)||void 0===l?void 0:l.trim().toLowerCase())&&(null===(i=e.descripcion)||void 0===i?void 0:i.trim().toLowerCase())===(null===(n=s.descripcion)||void 0===n?void 0:n.trim().toLowerCase())})?console.warn("⚠️ Este par ya fue agregado al carrito."):t([...e,{...s,cantidad:1,tempId:Date.now()+Math.random().toString(36).substring(2,9)}]);return}let a=e.findIndex(e=>e.id===s.id&&e.tipo===s.tipo&&!e.marca&&!e.modelo&&!e.descripcion);if(a>=0){let r=[...e];r[a].cantidad+=s.cantidad,t(r)}else t([...e,s])},B=s=>{let a=[...e];a.splice(s,1),t(a)},U=(s,a)=>{if(a<=0)return;let r=[...e];r[s].cantidad=a,t(r)},Y=e=>{_(e)},H=async a=>{if(!s){L("Por favor selecciona un cliente");return}if(0===e.length){L("El carrito est\xe1 vac\xedo");return}if(0===e.filter(e=>"servicio"===e.tipo).length){L("Debe haber al menos un servicio en la orden");return}let r=J(),l=r.totalConIvaTotal;if(a.monto<l){L("El monto pagado ($".concat(a.monto,") es menor al total de la orden ($").concat(l.toFixed(2),")"));return}try{var i;P(!0),L(null);let n=e.filter(e=>"servicio"===e.tipo).map(e=>({servicioId:"string"==typeof e.id?parseInt(e.id,10):e.id,cantidad:e.marca||e.modelo||e.descripcion?1:"string"==typeof e.cantidad?parseInt(e.cantidad,10):e.cantidad,modeloId:e.modeloId?"string"==typeof e.modeloId?parseInt(e.modeloId,10):e.modeloId:null,marca:e.marca||"",modelo:e.modelo||"",descripcion:e.descripcion||""})),o=e.filter(e=>"producto"===e.tipo).map(e=>({productoId:"string"==typeof e.id?parseInt(e.id,10):e.id,cantidad:"string"==typeof e.cantidad?parseInt(e.cantidad,10):e.cantidad})),c=null!==(i=s.cliente_id)&&void 0!==i?i:null;for(let e of n){let t=v.find(t=>t.servicio_id===e.servicioId);if(null==t?void 0:t.requiere_identificacion)break}let d={cliente:{cliente_id:c,nombre:s.nombre,apellidos:s.apellidos||"",telefono:s.telefono||"",email:s.email||""},servicios:n,productos:o,subtotal:r.subtotalTotal,iva:r.ivaTotal,total:r.totalConIvaTotal,metodoPago:a.metodoPago,monto:"string"==typeof a.monto?parseFloat(a.monto):a.monto,tieneIdentificacion:!!b,notas:p||""},m=await fetch("/api/admin/pos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}),x=await m.json();if(!m.ok||!x.success)throw Error(x.error||"Error al procesar la orden");t([]),u(null),h(""),g(!1),_("");let f=a.monto-l,j="\xa1Orden ".concat(x.codigoOrden," creada exitosamente!");f>0&&(j+="\n\nCambio a entregar: $".concat(f.toLocaleString("es-MX",{minimumFractionDigits:2}))),x.requiereIdentificacion&&!b&&(j+="\n\n⚠️ IMPORTANTE: Este servicio requiere identificaci\xf3n. Aseg\xfarate de solicitarla al cliente."),alert(j)}catch(e){console.error("❌ Error al procesar orden:",e),L(e instanceof Error?e.message:"Error al procesar la orden")}finally{P(!1)}};return M?(0,a.jsx)(q,{ordenId:M.ordenId,codigoOrden:M.codigoOrden,requiereIdentificacion:M.requiereIdentificacion,onStartNew:()=>{t([]),u(null),h(""),g(!1),k("servicios"),$(null),L(null)}}):(0,a.jsxs)("div",{className:"flex flex-col w-full h-full lg:flex-row",children:[(0,a.jsxs)("div",{className:"flex-1 flex flex-col p-4 lg:max-w-6xl overflow-hidden h-full",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-[#313D52]",children:"Punto de Venta"}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(l.A,{size:16,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar...",value:z,onChange:e=>Y(e.target.value),className:"py-2 pl-10 pr-4 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm w-64"})]})})]}),(0,a.jsxs)("div",{className:"flex mb-6 bg-[#f5f9f8] rounded-lg p-1",children:[(0,a.jsx)("button",{className:"flex-1 py-2 rounded-md transition-colors ".concat("servicios"===C?"bg-white shadow-sm text-[#313D52]":"text-[#6c7a89] hover:bg-white/50"),onClick:()=>k("servicios"),children:"Servicios"}),(0,a.jsx)("button",{className:"flex-1 py-2 rounded-md transition-colors ".concat("productos"===C?"bg-white shadow-sm text-[#313D52]":"text-[#6c7a89] hover:bg-white/50"),onClick:()=>k("productos"),children:"Productos"})]}),(0,a.jsx)("div",{className:"flex flex-wrap  overflow-y-auto pb-4",children:"servicios"===C?(0,a.jsx)(y,{onAddToCart:X,searchTerm:z}):(0,a.jsx)(j,{onAddToCart:X,searchTerm:z})})]}),(0,a.jsxs)("div",{className:"w-full lg:w-112 bg-[#f5f9f8] border-t lg:border-t-0 lg:border-l border-[#e0e6e5] flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"p-4 border-b border-[#e0e6e5]",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"font-medium text-[#313D52]",children:"Cliente"}),(0,a.jsxs)("button",{onClick:()=>D(!0),className:"flex items-center text-xs text-[#78f3d3] hover:underline",children:[(0,a.jsx)(i.A,{size:14,className:"mr-1"}),"Nuevo Cliente"]})]}),(0,a.jsx)(f,{onSelectClient:u,selectedClient:s})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"font-medium text-[#313D52]",children:"Carrito"}),(0,a.jsxs)("button",{onClick:()=>{window.confirm("\xbfEst\xe1s seguro de que quieres vaciar el carrito?")&&t([])},disabled:0===e.length,className:"flex items-center text-xs text-red-500 hover:underline disabled:opacity-50 disabled:hover:no-underline",children:[(0,a.jsx)(n.A,{size:14,className:"mr-1"}),"Vaciar"]})]}),0===e.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[(0,a.jsx)(o.A,{size:32,className:"text-[#e0e6e5] mb-2"}),(0,a.jsx)("p",{className:"text-[#6c7a89]",children:"El carrito est\xe1 vac\xedo"}),(0,a.jsx)("p",{className:"text-xs text-[#6c7a89] mt-1",children:"A\xf1ade productos o servicios para comenzar"})]}):(0,a.jsx)("div",{className:"space-y-3",children:e.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg shadow-sm",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-[#313D52]",children:e.nombre}),(0,a.jsxs)("div",{className:"text-sm text-[#6c7a89]",children:["$",Number(e.precio).toFixed(2)," x ",e.cantidad]}),e.modelo&&(0,a.jsxs)("div",{className:"text-xs text-[#6c7a89] mt-1",children:[e.marca," ",e.modelo]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"flex items-center border rounded-md overflow-hidden",children:[(0,a.jsx)("button",{onClick:()=>U(t,e.cantidad-1),className:"px-2 py-1 bg-[#f5f9f8] hover:bg-[#e0e6e5] text-[#313D52]",children:"-"}),(0,a.jsx)("span",{className:"px-2 py-1 bg-white",children:e.cantidad}),(0,a.jsx)("button",{onClick:()=>U(t,e.cantidad+1),className:"px-2 py-1 bg-[#f5f9f8] hover:bg-[#e0e6e5] text-[#313D52]",children:"+"})]}),(0,a.jsx)("button",{onClick:()=>B(t),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:(0,a.jsx)(c.A,{size:16})})]})]},t))})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-[#e0e6e5]",children:[(0,a.jsx)("label",{htmlFor:"notas",className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Notas de la orden"}),(0,a.jsx)("textarea",{id:"notas",rows:2,value:p,onChange:e=>h(e.target.value),placeholder:"Notas adicionales para la orden...",className:"w-full px-3 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm resize-none"})]}),(0,a.jsxs)("div",{className:"p-4 border-t border-[#e0e6e5] bg-white",children:[(0,a.jsx)(w,{subtotal:G(),iva:(()=>{let e=R();return e-G()})(),total:V()}),O&&(0,a.jsxs)("div",{className:"mt-4 p-3 bg-red-50 text-red-600 rounded-lg flex items-start",children:[(0,a.jsx)(d.A,{size:16,className:"mt-0.5 mr-2 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm",children:O})]}),(0,a.jsx)("button",{onClick:()=>I(!0),disabled:0===e.length||!s||T,className:"w-full mt-4 py-3 px-4 bg-[#78f3d3] text-[#313D52] font-medium rounded-lg flex items-center justify-center hover:bg-[#4de0c0] transition-colors disabled:opacity-50 disabled:hover:bg-[#78f3d3]",children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A,{size:20,className:"animate-spin mr-2"}),"Procesando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{size:20,className:"mr-2"}),"Procesar Pago"]})})]})]}),S&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-[#e0e6e5]",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-[#313D52]",children:"Nuevo Cliente"}),(0,a.jsx)("button",{onClick:()=>D(!1),className:"text-[#6c7a89] hover:text-[#313D52]",children:(0,a.jsx)(c.A,{size:24})})]}),(0,a.jsx)(F,{onSubmit:e=>{u(e),D(!1)},onCancel:()=>D(!1)})]})}),E&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-[#e0e6e5]",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-[#313D52]",children:"Procesar Pago"}),(0,a.jsx)("button",{onClick:()=>I(!1),className:"text-[#6c7a89] hover:text-[#313D52]",children:(0,a.jsx)(c.A,{size:24})})]}),(0,a.jsx)(A,{total:V(),onSubmit:H,onCancel:()=>I(!1)})]})})]})}},90929:(e,t,s)=>{Promise.resolve().then(s.bind(s,33302))}},e=>{var t=t=>e(e.s=t);e.O(0,[95,3680,8441,1684,7358],()=>t(90929)),_N_E=e.O()}]);