exports.id=8528,exports.ids=[8528],exports.modules={7699:(e,s,r)=>{"use strict";r.d(s,{N:()=>l});var t=r(13581),n=r(7462),i=r(85663);async function a(e){try{let s=e.toLowerCase().trim(),r=`
      SELECT 
        u.usuario_id, 
        u.email, 
        u.password, 
        u.rol, 
        u.activo,
        e.nombre,
        e.apellidos
      FROM usuarios u
      LEFT JOIN empleados e ON u.usuario_id = e.usuario_id
      WHERE u.email = ? AND u.activo = TRUE
    `,t=await (0,n.eW)({query:r,values:[s]});if(0===t.length)return null;return t[0]}catch(e){return console.error("Error al obtener usuario por email:",e),null}}async function o(e,s){try{return await (0,i.UD)(e,s)}catch(e){return console.error("Error al verificar la contrase\xf1a:",e),!1}}let l={providers:[(0,t.A)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;try{let s=await a(e.email);if(!s||!await o(e.password,s.password))return null;return{id:s.usuario_id.toString(),name:s.nombre?`${s.nombre} ${s.apellidos||""}`.trim():s.email,email:s.email,role:s.rol}}catch(e){return console.error("\uD83D\uDCA5 Error en autorizaci\xf3n:",e),null}}})],pages:{signIn:"/admin/login",error:"/admin/login"},session:{strategy:"jwt",maxAge:2592e3},callbacks:{jwt:async({token:e,user:s})=>(s&&(e.role=s.role,e.id=s.id),e),session:async({session:e,token:s})=>(e.user&&(e.user.role=s.role,e.user.id=s.id),e),redirect:async({url:e,baseUrl:s})=>e.includes("/admin/login")||e===s?`${s}/admin`:e.startsWith("/")?`${s}${e}`:e.startsWith(s)?e:`${s}/admin`},debug:!1,secret:"genera_un_secreto_aleatorio_largo"}},8392:(e,s,r)=>{Promise.resolve().then(r.t.bind(r,86346,23)),Promise.resolve().then(r.t.bind(r,27924,23)),Promise.resolve().then(r.t.bind(r,35656,23)),Promise.resolve().then(r.t.bind(r,40099,23)),Promise.resolve().then(r.t.bind(r,38243,23)),Promise.resolve().then(r.t.bind(r,28827,23)),Promise.resolve().then(r.t.bind(r,62763,23)),Promise.resolve().then(r.t.bind(r,97173,23))},21544:(e,s,r)=>{Promise.resolve().then(r.t.bind(r,16444,23)),Promise.resolve().then(r.t.bind(r,16042,23)),Promise.resolve().then(r.t.bind(r,88170,23)),Promise.resolve().then(r.t.bind(r,49477,23)),Promise.resolve().then(r.t.bind(r,29345,23)),Promise.resolve().then(r.t.bind(r,12089,23)),Promise.resolve().then(r.t.bind(r,46577,23)),Promise.resolve().then(r.t.bind(r,31307,23))},21632:(e,s,r)=>{"use strict";r.d(s,{default:()=>i});var t=r(60687),n=r(82136);function i({children:e,session:s}){return(0,t.jsx)(n.SessionProvider,{session:s,children:e})}},31150:(e,s,r)=>{"use strict";r.d(s,{default:()=>t});let t=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/santiserrano/Documents/GitHub/VipCleanersPos/components/SessionProvider.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/santiserrano/Documents/GitHub/VipCleanersPos/components/SessionProvider.tsx","default")},44903:(e,s,r)=>{Promise.resolve().then(r.bind(r,48497))},48497:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>E});var t=r(60687),n=r(43210),i=r(6276),a=r.n(i),o=r(85814),l=r.n(o),d=r(16189),c=r(32192),m=r(28561),u=r(19080),h=r(40228),x=r(58887),f=r(41312),p=r(85778),b=r(29409),v=r(84027),g=r(82679),j=r(41862),N=r(40083),P=r(82136);let y=({className:e,iconOnly:s=!1})=>{let[r,i]=(0,n.useState)(!1),a=(0,d.useRouter)(),o=async()=>{try{i(!0),await (0,P.signOut)({redirect:!1,callbackUrl:"/admin/login"}),a.push("/admin/login"),a.refresh()}catch(e){console.error("Error al cerrar sesi\xf3n:",e),a.push("/admin/login")}finally{i(!1)}};return(0,t.jsxs)("button",{onClick:o,disabled:r,className:`flex items-center ${r?"opacity-70 cursor-not-allowed":""} ${e||""}`,"aria-label":"Cerrar sesi\xf3n",children:[r?(0,t.jsx)(j.A,{size:20,className:"animate-spin mr-2"}):(0,t.jsx)(N.A,{size:20,className:s?"":"mr-2"}),!s&&(0,t.jsx)("span",{children:r?"Cerrando sesi\xf3n...":"Cerrar Sesi\xf3n"})]})},w=()=>{let e=(0,d.usePathname)(),s=[{name:"Dashboard",href:"/admin",icon:c.A},{name:"Punto de Venta",href:"/admin/pos",icon:m.A},{name:"\xd3rdenes",href:"/admin/orders",icon:u.A},{name:"Reservaciones",href:"/admin/bookings",icon:h.A},{name:"Mensajes",href:"/admin/messages",icon:x.A},{name:"Clientes",href:"/admin/clients",icon:f.A},{name:"Pagos",href:"/admin/payments",icon:p.A},{name:"Reportes",href:"/admin/reports",icon:b.A},{name:"Configuraci\xf3n",href:"/admin/settings",icon:v.A},{name:"Diagn\xf3stico",href:"/admin/debug",icon:g.A}],r=s=>"/admin"===s?"/admin"===e:e?.startsWith(s);return(0,t.jsxs)("div",{className:"h-full flex flex-col",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-[#e0e6e5]",children:[(0,t.jsxs)("span",{className:"text-xl font-bold text-[#313D52]",children:["Vip",(0,t.jsx)("span",{className:"text-[#78f3d3]",children:"Cleaners"})]}),(0,t.jsx)("div",{className:"text-xs text-[#6c7a89]",children:"Panel de Administraci\xf3n"})]}),(0,t.jsx)("nav",{className:"flex-1 py-6",children:(0,t.jsx)("ul",{className:"space-y-1 px-4",children:s.map(e=>{let s=e.icon,n=r(e.href);return(0,t.jsx)("li",{children:(0,t.jsxs)(l(),{href:e.href,className:`flex items-center p-3 rounded-lg transition-colors ${n?"bg-gradient-to-r from-[#4de0c0] to-[#4de0c0] text-[#313D52]":"text-[#6c7a89] hover:bg-[#e0e6e5] hover:text-[#313D52]"}`,children:[(0,t.jsx)(s,{size:20,className:"flex-shrink-0 mr-3"}),(0,t.jsx)("span",{children:e.name})]})},e.name)})})}),(0,t.jsx)("div",{className:"p-4 border-t border-[#e0e6e5]",children:(0,t.jsx)(y,{className:"flex items-center w-full p-3 rounded-lg text-[#6c7a89] hover:bg-[#e0e6e5] hover:text-[#313D52] transition-colors"})})]})};var C=r(99270),A=r(97051),D=r(58869);let S=()=>{let e=(0,d.usePathname)(),[s,r]=(0,n.useState)(""),{data:i}=(0,P.useSession)();return(0,t.jsx)("header",{className:"bg-white border-b border-[#e0e6e5] sticky top-0 z-10",children:(0,t.jsxs)("div",{className:"flex justify-between items-center px-4 py-3",children:[(0,t.jsx)("h1",{className:"text-lg md:text-xl font-semibold text-[#313D52] md:pl-2",children:"/admin"===e?"Dashboard":e?.startsWith("/admin/bookings")?"Reservaciones":e?.startsWith("/admin/messages")?"Mensajes de Contacto":e?.startsWith("/admin/users")?"Usuarios":e?.startsWith("/admin/settings")?"Configuraci\xf3n":"Panel de Administraci\xf3n"}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),console.log("Searching for:",s)},className:"hidden md:flex items-center relative",children:[(0,t.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,t.jsx)(C.A,{size:18,className:"text-[#6c7a89]"})}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar...",value:s,onChange:e=>{r(e.target.value)},className:"py-2 pl-10 pr-4 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm w-64"})]}),(0,t.jsxs)("button",{className:"relative p-2 text-[#6c7a89] hover:bg-[#f5f9f8] rounded-full",children:[(0,t.jsx)(A.A,{size:20}),(0,t.jsx)("span",{className:"absolute top-1 right-1 w-4 h-4 bg-[#78f3d3] rounded-full text-[10px] text-white flex items-center justify-center",children:"3"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-[#313D52] text-white flex items-center justify-center mr-2",children:(0,t.jsx)(D.A,{size:16})}),(0,t.jsxs)("div",{className:"hidden md:block",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-[#313D52]",children:i?.user?.name||"Admin"}),(0,t.jsx)("div",{className:"text-xs text-[#6c7a89]",children:i?.user?.email||"admin@kickclean.com"})]})]})]})]})})};function E({children:e}){let s="/admin/login"===(0,d.usePathname)();return(0,t.jsxs)("div",{className:`${a().variable} bg-[#f5f9f8] min-h-screen flex flex-col md:flex-row`,children:[!s&&(0,t.jsx)(w,{}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col",children:[!s&&(0,t.jsx)(S,{}),(0,t.jsx)("main",{className:"flex-1 p-4 md:p-6 overflow-auto",children:e})]})]})}},58014:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>o});var t=r(37413),n=r(35426),i=r(7699),a=r(31150);async function o({children:e}){let s=await (0,n.getServerSession)(i.N);return console.log("\uD83C\uDFE0 Root Layout - Server session:",!!s,s?.user?.role),(0,t.jsx)("html",{lang:"es",children:(0,t.jsx)("body",{children:(0,t.jsx)(a.default,{session:s,children:e})})})}},61775:(e,s,r)=>{Promise.resolve().then(r.bind(r,97786))},67362:(e,s,r)=>{Promise.resolve().then(r.bind(r,31150))},85514:(e,s,r)=>{Promise.resolve().then(r.bind(r,21632))},97786:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>t});let t=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/layout.tsx","default")}};