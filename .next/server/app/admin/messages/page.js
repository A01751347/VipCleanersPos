(()=>{var e={};e.id=6543,e.ids=[6543],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3498:e=>{"use strict";e.exports=require("mysql2/promise")},5023:(e,s,a)=>{Promise.resolve().then(a.bind(a,97481))},5336:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},6276:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c",variable:"__variable_e8ce0c"}},10022:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},11860:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},12412:e=>{"use strict";e.exports=require("assert")},12597:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},13861:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},16189:(e,s,a)=>{"use strict";var t=a(65773);a.o(t,"useParams")&&a.d(s,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(s,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(s,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(s,{useSearchParams:function(){return t.useSearchParams}})},19080:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27900:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},28354:e=>{"use strict";e.exports=require("util")},28561:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},28880:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/messages/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/messages/page.tsx","default")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29409:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("chart-no-axes-column",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]])},32192:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},33873:e=>{"use strict";e.exports=require("path")},39458:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("mail-open",[["path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z",key:"1jhwl8"}],["path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10",key:"1qfld7"}]])},40083:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]])},40228:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},41312:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},41550:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},41862:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},48730:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},58869:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},58887:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64398:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},74075:e=>{"use strict";e.exports=require("zlib")},74759:(e,s,a)=>{Promise.resolve().then(a.bind(a,28880))},77026:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]])},77743:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>o,routeModule:()=>x,tree:()=>d});var t=a(65239),r=a(48088),l=a(88170),i=a.n(l),n=a(30893),c={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);a.d(s,c);let d={children:["",{children:["admin",{children:["messages",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,28880)),"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/messages/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,97786)),"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,58014)),"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(a.t.bind(a,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(a.t.bind(a,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,o=["/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/messages/page.tsx"],m={require:a,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/admin/messages/page",pathname:"/admin/messages",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},82679:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]])},84027:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},85778:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},93613:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},94735:e=>{"use strict";e.exports=require("events")},97051:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},97481:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>w});var t=a(60687),r=a(43210),l=a(62688);let i=(0,l.A)("message-circle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);var n=a(41550),c=a(5336),d=a(64398),o=a(99270),m=a(41862),x=a(93613),u=a(39458),h=a(58869),p=a(77026),j=a(48730);let b=(0,l.A)("reply",[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]]);var y=a(11860),g=a(12597),f=a(13861),v=a(40228),N=a(10022),k=a(27900);let A=({isOpen:e,onClose:s,message:a,onReplySuccess:l})=>{let[i,d]=(0,r.useState)(""),[o,u]=(0,r.useState)(!0),[p,j]=(0,r.useState)(!0),[b,A]=(0,r.useState)(!0),[w,z]=(0,r.useState)(!1),[M,D]=(0,r.useState)(!1),[S,_]=(0,r.useState)(!1),[P,C]=(0,r.useState)(null),q=(0,r.useRef)(null);(0,r.useEffect)(()=>{e&&q.current&&q.current.focus()},[e]);let E=e=>{d(e.content.replace("{name}",a.name)),q.current&&q.current.focus()},H=async()=>{if(!i.trim()){C("Por favor escribe un mensaje de respuesta");return}D(!0),C(null);try{let e=await fetch(`/api/admin/messages/${a.id}/reply`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({replyMessage:i.trim(),includeOriginalMessage:o,markAsRead:p,saveInDatabase:b})}),s=await e.json();if(!e.ok)throw Error(s.error||"Error al enviar la respuesta");_(!0),l&&l(),setTimeout(()=>{R()},3e3)}catch(e){console.error("Error enviando respuesta:",e),C(e instanceof Error?e.message:"Error al enviar la respuesta")}finally{D(!1)}},R=()=>{M||S||(s(),d(""),C(null),_(!1),u(!0),j(!0),A(!0),z(!1))};return e?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center p-6 border-b border-[#e0e6e5]",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(n.A,{size:24,className:"text-[#78f3d3] mr-3"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-[#313D52]",children:"Responder Mensaje"}),(0,t.jsxs)("p",{className:"text-sm text-[#6c7a89]",children:["Para: ",a.name," <",a.email,">"]})]})]}),(0,t.jsx)("button",{onClick:R,disabled:M||S,className:"text-[#6c7a89] hover:text-[#313D52] disabled:opacity-50",children:(0,t.jsx)(y.A,{size:24})})]}),(0,t.jsx)("div",{className:"p-6",children:S?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-[#e0f7f0] rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(c.A,{size:32,className:"text-[#78f3d3]"})}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-[#313D52] mb-2",children:"\xa1Respuesta Enviada!"}),(0,t.jsx)("p",{className:"text-[#6c7a89] mb-4",children:"Tu respuesta ha sido enviada exitosamente a:"}),(0,t.jsx)("p",{className:"text-[#313D52] font-medium",children:a.email}),(0,t.jsx)("p",{className:"text-sm text-[#6c7a89] mt-2",children:"El mensaje se est\xe1 enviando por email..."})]}):(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-[#6c7a89] mb-2",children:"Mensaje de Respuesta *"}),(0,t.jsx)("textarea",{ref:q,value:i,onChange:e=>d(e.target.value),placeholder:"Escribe tu respuesta aqu\xed...",rows:12,className:"w-full px-3 py-2 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm resize-y",disabled:M}),(0,t.jsxs)("p",{className:"text-xs text-[#6c7a89] mt-1",children:[i.length," caracteres"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-[#6c7a89] mb-2",children:"Respuestas R\xe1pidas"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[{name:"Agradecimiento",content:"Hola {name},\n\nGracias por contactarnos. Hemos recibido tu mensaje y nos pondremos en contacto contigo muy pronto.\n\nSi tienes alguna pregunta urgente, no dudes en llamarnos.\n\nSaludos cordiales,"},{name:"Informaci\xf3n General",content:"Hola {name},\n\nGracias por tu inter\xe9s en nuestros servicios. Te enviamos la informaci\xf3n que solicitas:\n\n[Agregar informaci\xf3n espec\xedfica aqu\xed]\n\nSi necesitas m\xe1s detalles, estaremos encantados de ayudarte.\n\nSaludos,"},{name:"Cotizaci\xf3n",content:"Hola {name},\n\nGracias por tu solicitud de cotizaci\xf3n. Para poder brindarte un presupuesto preciso, necesitar\xedamos algunos detalles adicionales:\n\n• [Detalle 1]\n• [Detalle 2]\n• [Detalle 3]\n\nUna vez que tengamos esta informaci\xf3n, te enviaremos una cotizaci\xf3n detallada.\n\nSaludos,"},{name:"Disculpa por la demora",content:"Hola {name},\n\nPrimero que nada, queremos disculparnos por la demora en responder tu mensaje.\n\n[Respuesta espec\xedfica al mensaje]\n\nApreciamos tu paciencia y esperamos poder ayudarte.\n\nSaludos,"}].map((e,s)=>(0,t.jsx)("button",{onClick:()=>E(e),disabled:M,className:"px-3 py-2 text-xs bg-[#f5f9f8] text-[#313D52] rounded-lg hover:bg-[#e0e6e5] transition-colors disabled:opacity-50 text-left",children:e.name},s))})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"includeOriginal",checked:o,onChange:e=>u(e.target.checked),disabled:M,className:"mr-3"}),(0,t.jsx)("label",{htmlFor:"includeOriginal",className:"text-sm text-[#313D52]",children:"Incluir mensaje original en la respuesta"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"markAsRead",checked:p,onChange:e=>j(e.target.checked),disabled:M,className:"mr-3"}),(0,t.jsx)("label",{htmlFor:"markAsRead",className:"text-sm text-[#313D52]",children:"Marcar mensaje como le\xeddo"})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"checkbox",id:"saveInDatabase",checked:b,onChange:e=>A(e.target.checked),disabled:M,className:"mr-3"}),(0,t.jsx)("label",{htmlFor:"saveInDatabase",className:"text-sm text-[#313D52]",children:"Guardar respuesta en la base de datos"})]})]}),P&&(0,t.jsxs)("div",{className:"p-3 bg-red-50 text-red-600 rounded-lg flex items-start",children:[(0,t.jsx)(x.A,{size:16,className:"mt-0.5 mr-2 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-sm",children:P})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-[#6c7a89]",children:"Mensaje Original"}),(0,t.jsx)("button",{onClick:()=>z(!w),className:"flex items-center text-xs text-[#6c7a89] hover:text-[#313D52]",children:w?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.A,{size:14,className:"mr-1"}),"Ocultar Vista Previa"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.A,{size:14,className:"mr-1"}),"Mostrar Vista Previa"]})})]}),(0,t.jsx)("div",{className:"bg-[#f5f9f8] border border-[#e0e6e5] rounded-lg p-4",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(h.A,{size:16,className:"text-[#6c7a89] mr-2"}),(0,t.jsx)("span",{className:"text-sm font-medium text-[#313D52]",children:a.name})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(n.A,{size:16,className:"text-[#6c7a89] mr-2"}),(0,t.jsx)("span",{className:"text-sm text-[#313D52]",children:a.email})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(v.A,{size:16,className:"text-[#6c7a89] mr-2"}),(0,t.jsx)("span",{className:"text-sm text-[#6c7a89]",children:new Date(a.created_at).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:"flex items-center mb-2",children:[(0,t.jsx)(N.A,{size:16,className:"text-[#6c7a89] mr-2"}),(0,t.jsxs)("span",{className:"text-sm font-medium text-[#313D52]",children:["Asunto: ",a.subject]})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg p-3 border border-[#e0e6e5]",children:(0,t.jsx)("p",{className:"text-sm text-[#313D52] whitespace-pre-wrap leading-relaxed",children:a.message})})]})}),w&&o&&(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Vista Previa del Email"}),(0,t.jsxs)("div",{className:"text-xs text-blue-700 space-y-1",children:[(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Para:"})," ",a.email]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("strong",{children:"Asunto:"})," Re: ",a.subject]}),(0,t.jsx)("p",{children:(0,t.jsx)("strong",{children:"Incluir\xe1:"})}),(0,t.jsxs)("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[(0,t.jsx)("li",{children:"Tu mensaje de respuesta"}),(0,t.jsx)("li",{children:"El mensaje original del cliente"}),(0,t.jsx)("li",{children:"Informaci\xf3n de contacto de la empresa"}),(0,t.jsx)("li",{children:"Formato profesional HTML + texto plano"})]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-[#313D52] mb-2",children:"\uD83D\uDCA1 Consejos para una buena respuesta:"}),(0,t.jsxs)("ul",{className:"text-xs text-[#6c7a89] space-y-1",children:[(0,t.jsx)("li",{children:"• Saluda al cliente por su nombre"}),(0,t.jsx)("li",{children:"• S\xe9 espec\xedfico y claro en tu respuesta"}),(0,t.jsx)("li",{children:"• Incluye informaci\xf3n de contacto si es relevante"}),(0,t.jsx)("li",{children:"• Mant\xe9n un tono profesional y amigable"}),(0,t.jsx)("li",{children:"• Agradece al cliente por su inter\xe9s"})]})]})]})]})}),!S&&(0,t.jsxs)("div",{className:"flex justify-end space-x-3 p-6 border-t border-[#e0e6e5]",children:[(0,t.jsx)("button",{onClick:R,disabled:M,className:"px-4 py-2 border border-[#e0e6e5] text-[#6c7a89] rounded-lg hover:bg-[#f5f9f8] transition-colors disabled:opacity-50",children:"Cancelar"}),(0,t.jsx)("button",{onClick:H,disabled:M||!i.trim(),className:"px-6 py-2 bg-[#78f3d3] text-[#313D52] font-medium rounded-lg hover:bg-[#4de0c0] transition-colors flex items-center disabled:opacity-50 disabled:hover:bg-[#78f3d3]",children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.A,{size:18,className:"animate-spin mr-2"}),"Enviando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.A,{size:18,className:"mr-2"}),"Enviar Respuesta"]})})]})]})}):null};function w(){let[e,s]=(0,r.useState)([]),[a,l]=(0,r.useState)({total_mensajes:0,no_leidos:0,respondidos:0,sin_responder:0,destacados:0,archivados:0,promedio_respuesta_horas:0}),[y,g]=(0,r.useState)(!0),[f,v]=(0,r.useState)(null),[N,k]=(0,r.useState)(null),[w,z]=(0,r.useState)(!1),[M,D]=(0,r.useState)(1),[S,_]=(0,r.useState)(1),[P]=(0,r.useState)(10),[C,q]=(0,r.useState)("all"),[E,H]=(0,r.useState)(""),[R,V]=(0,r.useState)("fecha_creacion"),[G,T]=(0,r.useState)("desc"),[L,$]=(0,r.useState)({}),F=async()=>{try{g(!0);let e=new URLSearchParams({page:M.toString(),pageSize:P.toString(),filter:C,searchQuery:E,sortField:R,sortDirection:G}),a=await fetch(`/api/admin/messages?${e}`);if(!a.ok)throw Error("Error al cargar los mensajes");let t=await a.json();s(t.messages),_(t.totalPages),v(null)}catch(e){console.error("Error fetching messages:",e),v(e instanceof Error?e.message:"Error desconocido")}finally{g(!1)}},I=async()=>{try{let e=await fetch("/api/admin/messages/stats");if(e.ok){let s=await e.json();l(s)}}catch(e){console.error("Error fetching stats:",e)}},O=async(e,a,t)=>{try{if($(s=>({...s,[e]:!0})),!(await fetch(`/api/admin/messages/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:a,value:t})})).ok)throw Error("Error al actualizar el estado");s(s=>s.map(s=>s.id===e?{...s,[`is_${a}`]:t}:s)),I()}catch(e){console.error("Error updating status:",e),alert("Error al actualizar el estado del mensaje")}finally{$(s=>({...s,[e]:!1}))}},U=e=>{e.is_read||O(e.id,"read",!0),k(e),z(!0)},X=e=>new Date(e).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),Z=e=>{let s=new Date,a=new Date(e),t=Math.floor((s.getTime()-a.getTime())/36e5);if(t<1)return"Hace menos de 1 hora";if(t<24)return`Hace ${t} horas`;let r=Math.floor(t/24);return r<7?`Hace ${r} d\xedas`:X(e)},J=(e,s=100)=>e.length<=s?e:e.substring(0,s).trim()+"...";return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-[#313D52]",children:"Mensajes de Contacto"}),(0,t.jsx)("p",{className:"text-[#6c7a89] mt-1",children:"Gestiona todos los mensajes recibidos desde el formulario de contacto"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,t.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Total Mensajes"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-[#313D52]",children:a.total_mensajes})]}),(0,t.jsx)("div",{className:"p-3 bg-[#e0f7f0] rounded-lg",children:(0,t.jsx)(i,{size:24,className:"text-[#78f3d3]"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"No Le\xeddos"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:a.no_leidos})]}),(0,t.jsx)("div",{className:"p-3 bg-blue-100 rounded-lg",children:(0,t.jsx)(n.A,{size:24,className:"text-blue-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Respondidos"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:a.respondidos})]}),(0,t.jsx)("div",{className:"p-3 bg-green-100 rounded-lg",children:(0,t.jsx)(c.A,{size:24,className:"text-green-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Destacados"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:a.destacados})]}),(0,t.jsx)("div",{className:"p-3 bg-yellow-100 rounded-lg",children:(0,t.jsx)(d.A,{size:24,className:"text-yellow-600"})})]})})]}),(0,t.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between space-y-4 lg:space-y-0 lg:space-x-4",children:[(0,t.jsx)("div",{className:"flex-1 max-w-md",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(o.A,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[#6c7a89]"}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar mensajes...",value:E,onChange:e=>{H(e.target.value),D(1)},className:"w-full pl-10 pr-4 py-2 border border-[#e0e6e5] rounded-lg focus:outline-none focus:ring-2 focus:ring-[#78f3d3]"})]})}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"Todos",count:a.total_mensajes},{key:"unread",label:"No Le\xeddos",count:a.no_leidos},{key:"starred",label:"Destacados",count:a.destacados},{key:"archived",label:"Archivados",count:a.archivados}].map(({key:e,label:s,count:a})=>(0,t.jsxs)("button",{onClick:()=>{q(e),D(1)},className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${C===e?"bg-[#78f3d3] text-[#313D52]":"bg-gray-100 text-[#6c7a89] hover:bg-gray-200"}`,children:[s,a>0&&(0,t.jsx)("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs ${C===e?"bg-[#313D52] text-white":"bg-white text-[#6c7a89]"}`,children:a})]},e))})]})}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-[#e0e6e5]",children:[y?(0,t.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,t.jsx)(m.A,{size:40,className:"animate-spin text-[#78f3d3]"})}):f?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(x.A,{size:48,className:"text-red-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-[#313D52] mb-2",children:"Error al cargar mensajes"}),(0,t.jsx)("p",{className:"text-[#6c7a89] mb-4",children:f}),(0,t.jsx)("button",{onClick:F,className:"px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors",children:"Reintentar"})]}):0===e.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(n.A,{size:48,className:"text-[#6c7a89] mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-[#313D52] mb-2",children:"No hay mensajes"}),(0,t.jsx)("p",{className:"text-[#6c7a89]",children:"all"===C?"No se han recibido mensajes a\xfan.":`No hay mensajes ${"unread"===C?"no le\xeddos":"starred"===C?"destacados":"archivados"}.`})]}):(0,t.jsx)("div",{className:"divide-y divide-[#e0e6e5]",children:e.map(e=>(0,t.jsx)("div",{className:`p-4 hover:bg-[#f5f9f8] transition-colors ${e.is_read?"":"bg-blue-50"}`,children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0 mr-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("div",{className:"flex items-center",children:e.is_read?(0,t.jsx)(u.A,{size:16,className:"text-[#6c7a89]"}):(0,t.jsx)(n.A,{size:16,className:"text-blue-600"})}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(h.A,{size:14,className:"text-[#6c7a89] mr-1"}),(0,t.jsx)("span",{className:"font-semibold text-[#313D52]",children:e.name})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(n.A,{size:14,className:"text-[#6c7a89] mr-1"}),(0,t.jsx)("span",{className:"text-sm text-[#6c7a89]",children:e.email})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[e.is_starred?(0,t.jsx)(d.A,{size:14,className:"text-yellow-500"}):[null],e.is_archived?(0,t.jsx)(p.A,{size:14,className:"text-[#6c7a89]"}):[null]]})]}),(0,t.jsx)("h3",{className:"font-semibold text-[#313D52] mb-1",children:e.subject}),(0,t.jsx)("p",{className:"text-[#6c7a89] text-sm mb-2 leading-relaxed",children:J(e.message,120)}),(0,t.jsxs)("div",{className:"flex items-center text-xs text-[#6c7a89]",children:[(0,t.jsx)(j.A,{size:12,className:"mr-1"}),(0,t.jsx)("span",{children:Z(e.created_at)})]})]}),(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("div",{className:"flex space-x-2",children:(0,t.jsxs)("button",{onClick:()=>U(e),className:"flex items-center px-3 py-1.5 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors text-sm font-medium",title:"Responder mensaje",children:[(0,t.jsx)(b,{size:14,className:"mr-1"}),"Responder"]})}),(0,t.jsxs)("div",{className:"flex space-x-1",children:[!e.is_read&&(0,t.jsx)("button",{onClick:()=>O(e.id,"read",!0),disabled:L[e.id],className:"p-1.5 text-blue-600 hover:bg-blue-100 rounded transition-colors",title:"Marcar como le\xeddo",children:(0,t.jsx)(c.A,{size:14})}),(0,t.jsx)("button",{onClick:()=>O(e.id,"starred",!e.is_starred),disabled:L[e.id],className:`p-1.5 rounded transition-colors ${e.is_starred?"text-yellow-600 hover:bg-yellow-100":"text-[#6c7a89] hover:bg-gray-100"}`,title:e.is_starred?"Quitar destacado":"Destacar",children:(0,t.jsx)(d.A,{size:14})}),(0,t.jsx)("button",{onClick:()=>O(e.id,"archived",!e.is_archived),disabled:L[e.id],className:"p-1.5 text-[#6c7a89] hover:bg-gray-100 rounded transition-colors",title:e.is_archived?"Desarchivar":"Archivar",children:(0,t.jsx)(p.A,{size:14})})]})]})]})},e.id))}),S>1&&(0,t.jsxs)("div",{className:"flex justify-between items-center px-4 py-3 border-t border-[#e0e6e5]",children:[(0,t.jsxs)("p",{className:"text-sm text-[#6c7a89]",children:["P\xe1gina ",M," de ",S]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:()=>D(e=>Math.max(1,e-1)),disabled:1===M,className:"px-3 py-1 border border-[#e0e6e5] rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-[#f5f9f8]",children:"Anterior"}),(0,t.jsx)("button",{onClick:()=>D(e=>Math.min(S,e+1)),disabled:M===S,className:"px-3 py-1 border border-[#e0e6e5] rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-[#f5f9f8]",children:"Siguiente"})]})]})]}),N&&(0,t.jsx)(A,{isOpen:w,onClose:()=>{z(!1),k(null)},message:N,onReplySuccess:()=>{F(),I(),z(!1),k(null)}})]})}},99270:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(62688).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[4243,3104,4278,3889,7462,8528],()=>a(77743));module.exports=t})();