(()=>{var e={};e.id=6907,e.ids=[6907],e.modules={514:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>q});var a=t(60687),r=t(43210),l=t(31158),i=t(41862),n=t(78122),c=t(99270),d=t(47033),o=t(14952),x=t(48730),m=t(5336),u=t(35071),p=t(78272),h=t(81904),f=t(13861),b=t(19080);let j=(0,t(62688).A)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var g=t(88233),v=t(85814),N=t.n(v),y=t(11860),w=t(58869),k=t(41550),z=t(48340),A=t(97992),C=t(10022),D=t(40228);let _=({bookingId:e,isOpen:s,onClose:t,onStatusUpdate:l})=>{let n;let[c,d]=(0,r.useState)(null),[o,p]=(0,r.useState)(!1),[h,f]=(0,r.useState)(null),[j,g]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s&&e&&v()},[s,e]);let v=async()=>{if(e)try{p(!0),f(null);let s=await fetch(`/api/admin/bookings/${e}`);if(!s.ok){if(404===s.status)throw Error("Reservaci\xf3n no encontrada");throw Error("Error al cargar los detalles")}let t=await s.json();d(t)}catch(e){console.error("Error fetching booking details:",e),f(e instanceof Error?e.message:"Error desconocido")}finally{p(!1)}},N=async e=>{if(c)try{if(g(!0),!(await fetch(`/api/admin/bookings/${c.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e})})).ok)throw Error("Error al actualizar el estado");await v(),l&&l()}catch(e){console.error("Error updating status:",e),alert("Error al actualizar el estado de la reservaci\xf3n")}finally{g(!1)}},_=e=>e?new Date(e).toLocaleDateString("es-MX",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"No especificada";return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-[#e0e6e5]",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-[#313D52]",children:c?`Reservaci\xf3n ${c.booking_reference}`:"Detalles de Reservaci\xf3n"}),(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Informaci\xf3n completa de la reservaci\xf3n"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[c&&(0,a.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(c.status)}`,children:(e=>{switch(e){case"pending":return"Pendiente";case"completed":return"Completado";case"cancelled":return"Cancelado";default:return"Desconocido"}})(c.status)}),(0,a.jsx)("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,a.jsx)(y.A,{size:20,className:"text-[#6c7a89]"})})]})]}),(0,a.jsx)("div",{className:"p-6",children:o?(0,a.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,a.jsx)(i.A,{size:40,className:"animate-spin text-[#78f3d3]"})}):h?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-red-500 mb-4",children:(0,a.jsx)(u.A,{size:48,className:"mx-auto"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#313D52] mb-2",children:"Error"}),(0,a.jsx)("p",{className:"text-[#6c7a89] mb-4",children:h}),(0,a.jsx)("button",{onClick:v,className:"px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors",children:"Reintentar"})]}):c?(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)("div",{className:"border border-[#e0e6e5] rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(w.A,{size:18,className:"text-[#78f3d3] mr-2"}),(0,a.jsx)("h3",{className:"font-semibold text-[#313D52]",children:"Informaci\xf3n del Cliente"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Nombre Completo"}),(0,a.jsx)("p",{className:"text-[#313D52]",children:c.full_name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Email"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(k.A,{size:14,className:"text-[#6c7a89] mr-2"}),(0,a.jsx)("a",{href:`mailto:${c.client_email}`,className:"text-[#78f3d3] hover:underline",children:c.client_email})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Tel\xe9fono"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(z.A,{size:14,className:"text-[#6c7a89] mr-2"}),(0,a.jsx)("a",{href:`tel:${c.client_phone}`,className:"text-[#78f3d3] hover:underline",children:c.client_phone})]})]}),c.client_address&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Direcci\xf3n"}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(A.A,{size:14,className:"text-[#6c7a89] mr-2 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-[#313D52]",children:c.client_address}),c.client_city&&(0,a.jsxs)("p",{className:"text-xs text-[#6c7a89]",children:[c.client_city,c.client_postal_code&&`, ${c.client_postal_code}`]})]})]})]})]})]}),(0,a.jsxs)("div",{className:"border border-[#e0e6e5] rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(b.A,{size:18,className:"text-[#78f3d3] mr-2"}),(0,a.jsx)("h3",{className:"font-semibold text-[#313D52]",children:"Informaci\xf3n del Servicio"})]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Servicio"}),(0,a.jsx)("p",{className:"text-[#313D52] font-medium",children:c.service_name}),(0,a.jsx)("p",{className:"text-xs text-[#6c7a89]",children:c.service_description})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Precio"}),(0,a.jsx)("p",{className:"text-[#313D52] font-semibold",children:(n=c.service_price,new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(n))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Duraci\xf3n"}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.A,{size:14,className:"text-[#6c7a89] mr-1"}),(0,a.jsxs)("p",{className:"text-[#313D52]",children:[c.service_duration," min"]})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Calzado"}),(0,a.jsxs)("p",{className:"text-[#313D52]",children:[c.marca," ",c.modelo]}),c.shoes_description&&(0,a.jsx)("p",{className:"text-xs text-[#6c7a89] mt-1",children:c.shoes_description})]})]})]}),c.notes&&(0,a.jsxs)("div",{className:"border border-[#e0e6e5] rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)(C.A,{size:18,className:"text-[#78f3d3] mr-2"}),(0,a.jsx)("h3",{className:"font-semibold text-[#313D52]",children:"Notas"})]}),(0,a.jsx)("p",{className:"text-sm text-[#313D52] whitespace-pre-wrap",children:c.notes})]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border border-[#e0e6e5] rounded-lg p-4",children:[(0,a.jsx)("h3",{className:"font-semibold text-[#313D52] mb-4",children:"Acciones"}),(0,a.jsxs)("div",{className:"space-y-2",children:["pending"!==c.status&&(0,a.jsxs)("button",{onClick:()=>N("pending"),disabled:j,className:"w-full flex items-center justify-center px-3 py-2 bg-yellow-100 text-yellow-800 rounded-md hover:bg-yellow-200 transition-colors disabled:opacity-50 text-sm",children:[(0,a.jsx)(x.A,{size:14,className:"mr-2"}),"Pendiente"]}),"completed"!==c.status&&(0,a.jsxs)("button",{onClick:()=>N("completed"),disabled:j,className:"w-full flex items-center justify-center px-3 py-2 bg-green-100 text-green-800 rounded-md hover:bg-green-200 transition-colors disabled:opacity-50 text-sm",children:[(0,a.jsx)(m.A,{size:14,className:"mr-2"}),"Completado"]}),"cancelled"!==c.status&&(0,a.jsxs)("button",{onClick:()=>N("cancelled"),disabled:j,className:"w-full flex items-center justify-center px-3 py-2 bg-red-100 text-red-800 rounded-md hover:bg-red-200 transition-colors disabled:opacity-50 text-sm",children:[(0,a.jsx)(u.A,{size:14,className:"mr-2"}),"Cancelar"]})]})]}),(0,a.jsxs)("div",{className:"border border-[#e0e6e5] rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center mb-4",children:[(0,a.jsx)(D.A,{size:18,className:"text-[#78f3d3] mr-2"}),(0,a.jsx)("h3",{className:"font-semibold text-[#313D52]",children:"Fechas"})]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Reservaci\xf3n"}),(0,a.jsx)("p",{className:"text-[#313D52]",children:_(c.booking_date)})]}),c.estimated_delivery&&(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Entrega Estimada"}),(0,a.jsx)("p",{className:"text-[#313D52]",children:_(c.estimated_delivery)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-medium text-[#6c7a89] mb-1",children:"Creado"}),(0,a.jsx)("p",{className:"text-[#313D52]",children:_(c.created_at)})]})]})]})]})]}):null})]})}):null},E=e=>{let s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let t=t=>{s.current&&!s.current.contains(t.target)&&e()};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[e]),s},S=({bookings:e=[],onStatusChange:s})=>{let[t,l]=(0,r.useState)("booking_date"),[n,c]=(0,r.useState)("desc"),[d,o]=(0,r.useState)(null),[v,y]=(0,r.useState)(null),[w,k]=(0,r.useState)(null),[z,A]=(0,r.useState)(!1),C=E(()=>o(null)),D=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},S=e=>{switch(e){case"pending":return"Pendiente";case"completed":return"Completado";case"cancelled":return"Cancelado";default:return"Desconocido"}},P=e=>{switch(e){case"pending":default:return(0,a.jsx)(x.A,{size:14});case"completed":return(0,a.jsx)(m.A,{size:14});case"cancelled":return(0,a.jsx)(u.A,{size:14})}},q=e=>e?new Date(e).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",$=e=>{t===e?c("asc"===n?"desc":"asc"):(l(e),c("asc"))},M=e=>{o(d===e?null:e)},R=e=>{k(e),A(!0),o(null)},H=async e=>{if(confirm("\xbfEst\xe1s seguro de que deseas eliminar esta reservaci\xf3n?"))try{y(e),console.log(`Deleting booking with ID: ${e}`),s&&s()}catch(e){console.error("Error al eliminar la reserva:",e),alert("Error al eliminar la reserva")}finally{o(null),y(null)}},U=async(e,t)=>{try{if(y(e),!(await fetch(`/api/admin/bookings/${e}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok)throw Error("Error al actualizar el estado de la reserva");s&&s()}catch(e){console.error("Error al actualizar el estado de la reserva:",e),alert("Error al actualizar el estado de la reserva")}finally{o(null),y(null)}},I=e=>{switch(e){case"basic":return"Limpieza B\xe1sica";case"premium":return"Limpieza Premium";default:return e}};return 0===e.length?(0,a.jsx)("div",{className:"text-center py-10 text-[#6c7a89]",children:"No se encontraron reservaciones que coincidan con los criterios de b\xfasqueda"}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto",style:{minHeight:"400px"},children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-[#e0e6e5]",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider cursor-pointer hover:bg-[#f5f9f8]",onClick:()=>$("booking_reference"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{children:"Referencia"}),"booking_reference"===t&&(0,a.jsx)(p.A,{size:16,className:`ml-1 transform ${"asc"===n?"rotate-180":""}`})]})}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider cursor-pointer hover:bg-[#f5f9f8]",onClick:()=>$("full_name"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{children:"Cliente"}),"full_name"===t&&(0,a.jsx)(p.A,{size:16,className:`ml-1 transform ${"asc"===n?"rotate-180":""}`})]})}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider cursor-pointer hover:bg-[#f5f9f8]",onClick:()=>$("service_type"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{children:"Servicio"}),"service_type"===t&&(0,a.jsx)(p.A,{size:16,className:`ml-1 transform ${"asc"===n?"rotate-180":""}`})]})}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider cursor-pointer hover:bg-[#f5f9f8]",onClick:()=>$("booking_date"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{children:"Fecha"}),"booking_date"===t&&(0,a.jsx)(p.A,{size:16,className:`ml-1 transform ${"asc"===n?"rotate-180":""}`})]})}),(0,a.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-[#6c7a89] uppercase tracking-wider cursor-pointer hover:bg-[#f5f9f8]",onClick:()=>$("status"),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{children:"Estado"}),"status"===t&&(0,a.jsx)(p.A,{size:16,className:`ml-1 transform ${"asc"===n?"rotate-180":""}`})]})}),(0,a.jsx)("th",{className:"px-4 py-3 text-right text-xs font-medium text-[#6c7a89] uppercase tracking-wider",children:"Acciones"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-[#e0e6e5]",children:e.map(e=>(0,a.jsxs)("tr",{className:`hover:bg-[#f5f9f8] ${v===e.id?"opacity-50":""}`,children:[(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-[#313D52]",children:e.booking_reference}),(0,a.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-[#313D52]",children:e.full_name}),(0,a.jsx)("div",{className:"text-xs text-[#6c7a89]",children:e.email})]}),(0,a.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap",children:[(0,a.jsx)("div",{className:"text-sm text-[#313D52]",children:I(e.service_type)}),(0,a.jsxs)("div",{className:"text-xs text-[#6c7a89]",children:[e.marca," ",e.modelo]})]}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-[#6c7a89]",children:q(e.booking_date)}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:v===e.id?(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(i.A,{size:16,className:"animate-spin mr-2 text-[#78f3d3]"}),(0,a.jsx)("span",{className:"text-[#6c7a89] text-xs",children:"Actualizando..."})]}):(0,a.jsxs)("span",{className:`px-2 py-1 inline-flex items-center text-xs leading-5 font-semibold rounded-full ${D(e.status)}`,children:[(0,a.jsx)("span",{className:"mr-1",children:P(e.status)}),S(e.status)]})}),(0,a.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"relative inline-block text-left",ref:d===e.id?C:null,children:[(0,a.jsx)("button",{onClick:()=>M(e.id),className:"p-1 rounded-full hover:bg-[#e0e6e5] text-[#6c7a89]",disabled:v===e.id,children:(0,a.jsx)(h.A,{size:16})}),d===e.id&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white z-50 ring-1 ring-[#e0e6e5] divide-y divide-[#e0e6e5]",children:[(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("button",{onClick:()=>R(e.id),className:"flex items-center px-4 py-2 text-sm text-[#313D52] hover:bg-[#f5f9f8] w-full text-left",children:[(0,a.jsx)(f.A,{size:16,className:"mr-3 text-[#6c7a89]"}),"Ver detalles"]}),(0,a.jsxs)(N(),{href:`/admin/bookings/${e.id}`,className:"flex items-center px-4 py-2 text-sm text-[#313D52] hover:bg-[#f5f9f8]",children:[(0,a.jsx)(b.A,{size:16,className:"mr-3 text-[#6c7a89]"}),"P\xe1gina completa"]}),(0,a.jsxs)(N(),{href:`/admin/bookings/${e.id}/edit`,className:"flex items-center px-4 py-2 text-sm text-[#313D52] hover:bg-[#f5f9f8]",children:[(0,a.jsx)(j,{size:16,className:"mr-3 text-[#6c7a89]"}),"Editar"]})]}),(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsxs)("button",{onClick:()=>U(e.id,"pending"),className:"flex items-center px-4 py-2 text-sm text-[#313D52] hover:bg-[#f5f9f8] w-full text-left",disabled:"pending"===e.status,children:[(0,a.jsx)("span",{className:"w-4 h-4 mr-3 rounded-full bg-yellow-100 flex items-center justify-center",children:(0,a.jsx)(x.A,{size:12,className:"text-yellow-800"})}),"Marcar como Pendiente"]}),(0,a.jsxs)("button",{onClick:()=>U(e.id,"completed"),className:"flex items-center px-4 py-2 text-sm text-[#313D52] hover:bg-[#f5f9f8] w-full text-left",disabled:"completed"===e.status,children:[(0,a.jsx)("span",{className:"w-4 h-4 mr-3 rounded-full bg-green-100 flex items-center justify-center",children:(0,a.jsx)(m.A,{size:12,className:"text-green-800"})}),"Marcar como Completado"]}),(0,a.jsxs)("button",{onClick:()=>U(e.id,"cancelled"),className:"flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",disabled:"cancelled"===e.status,children:[(0,a.jsx)("span",{className:"w-4 h-4 mr-3 rounded-full bg-red-100 flex items-center justify-center",children:(0,a.jsx)(u.A,{size:12,className:"text-red-800"})}),"Cancelar Reservaci\xf3n"]})]}),(0,a.jsx)("div",{className:"py-1",children:(0,a.jsxs)("button",{onClick:()=>H(e.id),className:"flex items-center px-4 py-2 text-sm text-red-600 hover:bg-red-50 w-full text-left",children:[(0,a.jsx)(g.A,{size:16,className:"mr-3"}),"Eliminar"]})})]})]})})]},e.id))})]})}),(0,a.jsx)(_,{bookingId:w,isOpen:z,onClose:()=>{A(!1),k(null)},onStatusUpdate:()=>{s&&s()}})]})};var P=t(46699);function q(){let[e,s]=(0,r.useState)(""),[t,x]=(0,r.useState)(1),[m,u]=(0,r.useState)([]),[p,h]=(0,r.useState)({start:"",end:""}),[f,b]=(0,r.useState)([]),[j,g]=(0,r.useState)(0),[v,N]=(0,r.useState)(1),[y]=(0,r.useState)(10),[w,k]=(0,r.useState)(!0),[z,A]=(0,r.useState)(!1),[C,D]=(0,r.useState)(null),_=async(s=t,a=m,r=e,l=p)=>{try{A(!0);let e=`/api/admin/bookings?page=${s}&pageSize=${y}`;a&&a.length>0&&(e+=`&status=${a.join(",")}`),r&&(e+=`&search=${encodeURIComponent(r)}`),l.start&&(e+=`&startDate=${encodeURIComponent(l.start)}`),l.end&&(e+=`&endDate=${encodeURIComponent(l.end)}`);let t=await fetch(e);if(!t.ok)throw Error("Error al cargar las reservaciones");let i=await t.json();b(i.bookings||[]),g(i.total||0),N(i.totalPages||1),D(null)}catch(e){console.error("Error fetching bookings:",e),D("Error al cargar las reservaciones. Intente nuevamente.")}finally{k(!1),A(!1)}},E=s=>{let{name:t,value:a}=s.target,r={...p,[t]:a};h(r),("start"===t&&a&&p.end||"end"===t&&a&&p.start)&&(x(1),_(1,m,e,r))},q=()=>{_(t,m,e,p)};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-[#313D52]",children:"Administrar Reservaciones"}),(0,a.jsx)("p",{className:"text-sm text-[#6c7a89]",children:"Visualiza y gestiona las reservaciones de los clientes"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsxs)("button",{onClick:()=>{console.log("Exportando datos..."),alert("Funcionalidad de exportaci\xf3n no implementada a\xfan")},className:"inline-flex items-center px-4 py-2 bg-[#f5f9f8] text-[#313D52] rounded-lg border border-[#e0e6e5] hover:bg-[#e0e6e5] transition-colors",children:[(0,a.jsx)(l.A,{size:16,className:"mr-2"}),"Exportar"]}),(0,a.jsx)("button",{className:"inline-flex items-center px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",onClick:q,disabled:z,children:z?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.A,{size:16,className:"mr-2 animate-spin"}),"Actualizando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.A,{size:16,className:"mr-2"}),"Actualizar"]})})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] p-4",children:(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,a.jsx)("div",{className:"md:flex-1",children:(0,a.jsxs)("form",{onSubmit:s=>{s.preventDefault(),x(1),_(1,m,e,p)},className:"flex items-center relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(c.A,{size:18,className:"text-[#6c7a89]"})}),(0,a.jsx)("input",{type:"text",placeholder:"Buscar por cliente, referencia o tipo de servicio...",value:e,onChange:e=>{s(e.target.value)},className:"py-2 pl-10 pr-4 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm w-full"})]})}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(P.A,{selectedStatus:m,onChange:s=>{u(s),x(1),_(1,s,e,p)}})}),(0,a.jsxs)("div",{className:"flex-shrink-0 flex flex-col sm:flex-row gap-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"startDate",className:"block text-xs text-[#6c7a89] mb-1",children:"Desde"}),(0,a.jsx)("input",{type:"date",id:"startDate",name:"start",value:p.start,onChange:E,className:"py-2 px-3 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm w-full"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"endDate",className:"block text-xs text-[#6c7a89] mb-1",children:"Hasta"}),(0,a.jsx)("input",{type:"date",id:"endDate",name:"end",value:p.end,onChange:E,className:"py-2 px-3 rounded-lg border border-[#e0e6e5] focus:outline-none focus:ring-2 focus:ring-[#78f3d3] text-sm w-full"})]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-[#e0e6e5] overflow-hidden",children:[w?(0,a.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,a.jsx)(i.A,{size:40,className:"animate-spin text-[#78f3d3]"})}):C?(0,a.jsxs)("div",{className:"text-center py-10 text-red-500",children:[(0,a.jsx)("p",{children:C}),(0,a.jsx)("button",{onClick:q,className:"mt-4 px-4 py-2 bg-[#78f3d3] text-[#313D52] rounded-lg hover:bg-[#4de0c0] transition-colors",children:"Reintentar"})]}):0===f.length?(0,a.jsx)("div",{className:"text-center py-10 text-[#6c7a89]",children:(0,a.jsx)("p",{children:"No se encontraron reservaciones"})}):(0,a.jsx)(S,{bookings:f,onStatusChange:q}),!w&&!C&&f.length>0&&(0,a.jsxs)("div",{className:"px-4 py-3 flex items-center justify-between border-t border-[#e0e6e5]",children:[(0,a.jsxs)("div",{className:"text-sm text-[#6c7a89]",children:["Mostrando ",(0,a.jsx)("span",{className:"font-medium",children:(t-1)*y+1})," a ",(0,a.jsx)("span",{className:"font-medium",children:Math.min(t*y,j)})," de ",(0,a.jsx)("span",{className:"font-medium",children:j})," resultados"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{if(t>1){let s=t-1;x(s),_(s,m,e,p)}},disabled:1===t,className:`p-2 rounded-lg ${1===t?"text-[#e0e6e5] cursor-not-allowed":"text-[#313D52] hover:bg-[#f5f9f8]"}`,children:(0,a.jsx)(d.A,{size:20})}),(0,a.jsxs)("span",{className:"text-sm text-[#313D52]",children:["P\xe1gina ",(0,a.jsx)("span",{className:"font-medium",children:t})," de ",(0,a.jsx)("span",{className:"font-medium",children:v})]}),(0,a.jsx)("button",{onClick:()=>{if(t<v){let s=t+1;x(s),_(s,m,e,p)}},disabled:t===v,className:`p-2 rounded-lg ${t===v?"text-[#e0e6e5] cursor-not-allowed":"text-[#313D52] hover:bg-[#f5f9f8]"}`,children:(0,a.jsx)(o.A,{size:20})})]})]})]})]})}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3498:e=>{"use strict";e.exports=require("mysql2/promise")},10022:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:e=>{"use strict";e.exports=require("querystring")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},35071:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},41550:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},46699:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var a=t(60687),r=t(43210),l=t(80462),i=t(13964);let n=({selectedStatus:e,onChange:s})=>{let[t,n]=(0,r.useState)(!1),c=[{value:"pending",label:"Pendiente",color:"bg-yellow-100 text-yellow-800"},{value:"completed",label:"Completado",color:"bg-green-100 text-green-800"},{value:"cancelled",label:"Cancelado",color:"bg-red-100 text-red-800"}],d=t=>{e.includes(t)?s(e.filter(e=>e!==t)):s([...e,t])};return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("button",{onClick:()=>n(!t),className:"inline-flex items-center justify-between px-4 py-2 w-48 rounded-lg border border-[#e0e6e5] bg-white hover:bg-[#f5f9f8] focus:outline-none focus:ring-2 focus:ring-[#78f3d3]",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(l.A,{size:16,className:"mr-2 text-[#6c7a89]"}),(0,a.jsx)("span",{className:"text-sm",children:0===e.length?"Todos los estados":1===e.length?c.find(s=>s.value===e[0])?.label:`${e.length} estados`})]})}),t&&(0,a.jsx)("div",{className:"absolute mt-1 w-64 bg-white border border-[#e0e6e5] rounded-lg shadow-lg z-10",children:(0,a.jsxs)("div",{className:"p-2",children:[(0,a.jsxs)("button",{onClick:()=>{e.length===c.length?s([]):s(c.map(e=>e.value))},className:"flex items-center justify-between w-full px-3 py-2 text-sm text-left rounded-md hover:bg-[#f5f9f8]",children:[(0,a.jsx)("span",{children:e.length===c.length?"Deseleccionar todos":"Seleccionar todos"}),e.length===c.length&&(0,a.jsx)(i.A,{size:16,className:"text-[#78f3d3]"})]}),(0,a.jsx)("div",{className:"h-px bg-[#e0e6e5] my-1"}),c.map(s=>(0,a.jsxs)("button",{onClick:()=>d(s.value),className:"flex items-center justify-between w-full px-3 py-2 text-sm text-left rounded-md hover:bg-[#f5f9f8]",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:`inline-block w-2 h-2 rounded-full mr-2 ${s.color.split(" ")[0]}`}),(0,a.jsx)("span",{children:s.label})]}),e.includes(s.value)&&(0,a.jsx)(i.A,{size:16,className:"text-[#78f3d3]"})]},s.value))]})})]})}},48340:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69903:(e,s,t)=>{Promise.resolve().then(t.bind(t,73908))},73908:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/bookings/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/bookings/page.tsx","default")},74075:e=>{"use strict";e.exports=require("zlib")},78151:(e,s,t)=>{Promise.resolve().then(t.bind(t,514))},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79915:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>d});var a=t(65239),r=t(48088),l=t(88170),i=t.n(l),n=t(30893),c={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d={children:["",{children:["admin",{children:["bookings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,73908)),"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/bookings/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,97786)),"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,58014)),"/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,o=["/Users/santiserrano/Documents/GitHub/VipCleanersPos/app/admin/bookings/page.tsx"],x={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/admin/bookings/page",pathname:"/admin/bookings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},81630:e=>{"use strict";e.exports=require("http")},94735:e=>{"use strict";e.exports=require("events")},97992:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(62688).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[4243,3104,4278,3889,7333,7462,8528],()=>t(79915));module.exports=a})();